(function(){var getRootNode=function(){if(this["document"]&&this["document"]["getElementsByTagName"]){var scripts=document.getElementsByTagName("script");var pat=/jquery\.jqplot\.js/i;for(var i=0;i<scripts.length;i++){var src=scripts[i].getAttribute("src");if(!src){continue;}
var m=src.match(pat);if(m){return{node:scripts[i],root:src.substring(0,m.index)};}}}};var files=['jqplot.core.js','jqplot.linearTickGenerator.js','jqplot.linearAxisRenderer.js','jqplot.axisTickRenderer.js','jqplot.axisLabelRenderer.js','jqplot.tableLegendRenderer.js','jqplot.lineRenderer.js','jqplot.markerRenderer.js','jqplot.divTitleRenderer.js','jqplot.canvasGridRenderer.js','jqplot.linePattern.js','jqplot.shadowRenderer.js','jqplot.shapeRenderer.js','jqplot.sprintf.js','jsdate.js','jqplot.themeEngine.js','jqplot.toImage.js','jqplot.effects.core.js','jqplot.effects.blind.js'];var rn=getRootNode().root;for(var i=0;i<files.length;i++){var pp=rn+files[i];try{document.write("<scr"+"ipt type='text/javascript' src='"+pp+"'></scr"+"ipt>\n");}catch(e){var script=document.createElement("script");script.src=pp;document.getElementsByTagName("head")[0].appendChild(script);script=null;}}})();(function($){$.jqplot.BarRenderer=function(){$.jqplot.LineRenderer.call(this);};$.jqplot.BarRenderer.prototype=new $.jqplot.LineRenderer();$.jqplot.BarRenderer.prototype.constructor=$.jqplot.BarRenderer;$.jqplot.BarRenderer.prototype.init=function(options,plot){this.barPadding=8;this.barMargin=10;this.barDirection='vertical';this.barWidth=null;this.shadowOffset=2;this.shadowDepth=5;this.shadowAlpha=0.08;this.waterfall=false;this.groups=1;this.varyBarColor=false;this.highlightMouseOver=true;this.highlightMouseDown=false;this.highlightColors=[];this.transposedData=true;this.renderer.animation={show:false,direction:'down',speed:3000,_supported:true};this._type='bar';if(options.highlightMouseDown&&options.highlightMouseOver==null){options.highlightMouseOver=false;}
$.extend(true,this,options);$.extend(true,this.renderer,options);this.fill=true;if(this.barDirection==='horizontal'&&this.rendererOptions.animation&&this.rendererOptions.animation.direction==null){this.renderer.animation.direction='left';}
if(this.waterfall){this.fillToZero=false;this.disableStack=true;}
if(this.barDirection=='vertical'){this._primaryAxis='_xaxis';this._stackAxis='y';this.fillAxis='y';}
else{this._primaryAxis='_yaxis';this._stackAxis='x';this.fillAxis='x';}
this._highlightedPoint=null;this._plotSeriesInfo=null;this._dataColors=[];this._barPoints=[];var opts={lineJoin:'miter',lineCap:'round',fill:true,isarc:false,strokeStyle:this.color,fillStyle:this.color,closePath:this.fill};this.renderer.shapeRenderer.init(opts);var sopts={lineJoin:'miter',lineCap:'round',fill:true,isarc:false,angle:this.shadowAngle,offset:this.shadowOffset,alpha:this.shadowAlpha,depth:this.shadowDepth,closePath:this.fill};this.renderer.shadowRenderer.init(sopts);plot.postInitHooks.addOnce(postInit);plot.postDrawHooks.addOnce(postPlotDraw);plot.eventListenerHooks.addOnce('jqplotMouseMove',handleMove);plot.eventListenerHooks.addOnce('jqplotMouseDown',handleMouseDown);plot.eventListenerHooks.addOnce('jqplotMouseUp',handleMouseUp);plot.eventListenerHooks.addOnce('jqplotClick',handleClick);plot.eventListenerHooks.addOnce('jqplotRightClick',handleRightClick);};function barPreInit(target,data,seriesDefaults,options){if(this.rendererOptions.barDirection=='horizontal'){this._stackAxis='x';this._primaryAxis='_yaxis';}
if(this.rendererOptions.waterfall==true){this._data=$.extend(true,[],this.data);var sum=0;var pos=(!this.rendererOptions.barDirection||this.rendererOptions.barDirection==='vertical'||this.transposedData===false)?1:0;for(var i=0;i<this.data.length;i++){sum+=this.data[i][pos];if(i>0){this.data[i][pos]+=this.data[i-1][pos];}}
this.data[this.data.length]=(pos==1)?[this.data.length+1,sum]:[sum,this.data.length+1];this._data[this._data.length]=(pos==1)?[this._data.length+1,sum]:[sum,this._data.length+1];}
if(this.rendererOptions.groups>1){this.breakOnNull=true;var l=this.data.length;var skip=parseInt(l/this.rendererOptions.groups,10);var count=0;for(var i=skip;i<l;i+=skip){this.data.splice(i+count,0,[null,null]);this._plotData.splice(i+count,0,[null,null]);this._stackData.splice(i+count,0,[null,null]);count++;}
for(i=0;i<this.data.length;i++){if(this._primaryAxis=='_xaxis'){this.data[i][0]=i+1;this._plotData[i][0]=i+1;this._stackData[i][0]=i+1;}
else{this.data[i][1]=i+1;this._plotData[i][1]=i+1;this._stackData[i][1]=i+1;}}}}
$.jqplot.preSeriesInitHooks.push(barPreInit);$.jqplot.BarRenderer.prototype.calcSeriesNumbers=function(){var nvals=0;var nseries=0;var paxis=this[this._primaryAxis];var s,series,pos;for(var i=0;i<paxis._series.length;i++){series=paxis._series[i];if(series===this){pos=i;}
if(series.renderer.constructor==$.jqplot.BarRenderer){nvals+=series.data.length;nseries+=1;}}
return[nvals,nseries,pos];};$.jqplot.BarRenderer.prototype.setBarWidth=function(){var i;var nvals=0;var nseries=0;var paxis=this[this._primaryAxis];var s,series,pos;var temp=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);nvals=temp[0];nseries=temp[1];var nticks=paxis.numberTicks;var nbins=(nticks-1)/2;if(paxis.name=='xaxis'||paxis.name=='x2axis'){if(this._stack){this.barWidth=(paxis._offsets.max-paxis._offsets.min)/nvals*nseries-this.barMargin;}
else{this.barWidth=((paxis._offsets.max-paxis._offsets.min)/nbins-this.barPadding*(nseries-1)-this.barMargin*2)/nseries;}}
else{if(this._stack){this.barWidth=(paxis._offsets.min-paxis._offsets.max)/nvals*nseries-this.barMargin;}
else{this.barWidth=((paxis._offsets.min-paxis._offsets.max)/nbins-this.barPadding*(nseries-1)-this.barMargin*2)/nseries;}}
return[nvals,nseries];};function computeHighlightColors(colors){var ret=[];for(var i=0;i<colors.length;i++){var rgba=$.jqplot.getColorComponents(colors[i]);var newrgb=[rgba[0],rgba[1],rgba[2]];var sum=newrgb[0]+newrgb[1]+newrgb[2];for(var j=0;j<3;j++){newrgb[j]=(sum>570)?newrgb[j]*0.8:newrgb[j]+0.3*(255-newrgb[j]);newrgb[j]=parseInt(newrgb[j],10);}
ret.push('rgb('+newrgb[0]+','+newrgb[1]+','+newrgb[2]+')');}
return ret;}
function getStart(sidx,didx,comp,plot,axis){var seriesIndex=sidx,prevSeriesIndex=sidx-1,start,prevVal,aidx=(axis==='x')?0:1;if(seriesIndex>0){prevVal=plot.series[prevSeriesIndex]._plotData[didx][aidx];if((comp*prevVal)<0){start=getStart(prevSeriesIndex,didx,comp,plot,axis);}
else{start=plot.series[prevSeriesIndex].gridData[didx][aidx];}}
else{start=(aidx===0)?plot.series[seriesIndex]._xaxis.series_u2p(0):plot.series[seriesIndex]._yaxis.series_u2p(0);}
return start;}
$.jqplot.BarRenderer.prototype.draw=function(ctx,gridData,options,plot){var i;var opts=$.extend({},options);var shadow=(opts.shadow!=undefined)?opts.shadow:this.shadow;var showLine=(opts.showLine!=undefined)?opts.showLine:this.showLine;var fill=(opts.fill!=undefined)?opts.fill:this.fill;var xaxis=this.xaxis;var yaxis=this.yaxis;var xp=this._xaxis.series_u2p;var yp=this._yaxis.series_u2p;var pointx,pointy;this._dataColors=[];this._barPoints=[];if(this.barWidth==null){this.renderer.setBarWidth.call(this);}
var temp=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);var nvals=temp[0];var nseries=temp[1];var pos=temp[2];var points=[];if(this._stack){this._barNudge=0;}
else{this._barNudge=(-Math.abs(nseries/2-0.5)+pos)*(this.barWidth+this.barPadding);}
if(showLine){var negativeColors=new $.jqplot.ColorGenerator(this.negativeSeriesColors);var positiveColors=new $.jqplot.ColorGenerator(this.seriesColors);var negativeColor=negativeColors.get(this.index);if(!this.useNegativeColors){negativeColor=opts.fillStyle;}
var positiveColor=opts.fillStyle;var base;var xstart;var ystart;if(this.barDirection=='vertical'){for(var i=0;i<gridData.length;i++){if(!this._stack&&this.data[i][1]==null){continue;}
points=[];base=gridData[i][0]+this._barNudge;if(this._stack&&this._prevGridData.length){ystart=getStart(this.index,i,this._plotData[i][1],plot,'y');}
else{if(this.fillToZero){ystart=this._yaxis.series_u2p(0);}
else if(this.waterfall&&i>0&&i<this.gridData.length-1){ystart=this.gridData[i-1][1];}
else if(this.waterfall&&i==0&&i<this.gridData.length-1){if(this._yaxis.min<=0&&this._yaxis.max>=0){ystart=this._yaxis.series_u2p(0);}
else if(this._yaxis.min>0){ystart=ctx.canvas.height;}
else{ystart=0;}}
else if(this.waterfall&&i==this.gridData.length-1){if(this._yaxis.min<=0&&this._yaxis.max>=0){ystart=this._yaxis.series_u2p(0);}
else if(this._yaxis.min>0){ystart=ctx.canvas.height;}
else{ystart=0;}}
else{ystart=ctx.canvas.height;}}
if((this.fillToZero&&this._plotData[i][1]<0)||(this.waterfall&&this._data[i][1]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){opts.fillStyle=negativeColors.next();}
else{opts.fillStyle=positiveColors.next();}}
else{opts.fillStyle=negativeColor;}}
else{if(this.varyBarColor&&!this._stack){opts.fillStyle=positiveColors.next();}
else{opts.fillStyle=positiveColor;}}
if(!this.fillToZero||this._plotData[i][1]>=0){points.push([base-this.barWidth/2,ystart]);points.push([base-this.barWidth/2,gridData[i][1]]);points.push([base+this.barWidth/2,gridData[i][1]]);points.push([base+this.barWidth/2,ystart]);}
else{points.push([base-this.barWidth/2,gridData[i][1]]);points.push([base-this.barWidth/2,ystart]);points.push([base+this.barWidth/2,ystart]);points.push([base+this.barWidth/2,gridData[i][1]]);}
this._barPoints.push(points);if(shadow&&!this._stack){var sopts=$.extend(true,{},opts);delete sopts.fillStyle;this.renderer.shadowRenderer.draw(ctx,points,sopts);}
var clr=opts.fillStyle||this.color;this._dataColors.push(clr);this.renderer.shapeRenderer.draw(ctx,points,opts);}}
else if(this.barDirection=='horizontal'){for(var i=0;i<gridData.length;i++){if(!this._stack&&this.data[i][0]==null){continue;}
points=[];base=gridData[i][1]-this._barNudge;xstart;if(this._stack&&this._prevGridData.length){xstart=getStart(this.index,i,this._plotData[i][0],plot,'x');}
else{if(this.fillToZero){xstart=this._xaxis.series_u2p(0);}
else if(this.waterfall&&i>0&&i<this.gridData.length-1){xstart=this.gridData[i-1][0];}
else if(this.waterfall&&i==0&&i<this.gridData.length-1){if(this._xaxis.min<=0&&this._xaxis.max>=0){xstart=this._xaxis.series_u2p(0);}
else if(this._xaxis.min>0){xstart=0;}
else{xstart=0;}}
else if(this.waterfall&&i==this.gridData.length-1){if(this._xaxis.min<=0&&this._xaxis.max>=0){xstart=this._xaxis.series_u2p(0);}
else if(this._xaxis.min>0){xstart=0;}
else{xstart=ctx.canvas.width;}}
else{xstart=0;}}
if((this.fillToZero&&this._plotData[i][0]<0)||(this.waterfall&&this._data[i][0]<0)){if(this.varyBarColor&&!this._stack){if(this.useNegativeColors){opts.fillStyle=negativeColors.next();}
else{opts.fillStyle=positiveColors.next();}}
else{opts.fillStyle=negativeColor;}}
else{if(this.varyBarColor&&!this._stack){opts.fillStyle=positiveColors.next();}
else{opts.fillStyle=positiveColor;}}
if(!this.fillToZero||this._plotData[i][0]>=0){points.push([xstart,base+this.barWidth/2]);points.push([xstart,base-this.barWidth/2]);points.push([gridData[i][0],base-this.barWidth/2]);points.push([gridData[i][0],base+this.barWidth/2]);}
else{points.push([gridData[i][0],base+this.barWidth/2]);points.push([gridData[i][0],base-this.barWidth/2]);points.push([xstart,base-this.barWidth/2]);points.push([xstart,base+this.barWidth/2]);}
this._barPoints.push(points);if(shadow&&!this._stack){var sopts=$.extend(true,{},opts);delete sopts.fillStyle;this.renderer.shadowRenderer.draw(ctx,points,sopts);}
var clr=opts.fillStyle||this.color;this._dataColors.push(clr);this.renderer.shapeRenderer.draw(ctx,points,opts);}}}
if(this.highlightColors.length==0){this.highlightColors=$.jqplot.computeHighlightColors(this._dataColors);}
else if(typeof(this.highlightColors)=='string'){var temp=this.highlightColors;this.highlightColors=[];for(var i=0;i<this._dataColors.length;i++){this.highlightColors.push(temp);}}};$.jqplot.BarRenderer.prototype.drawShadow=function(ctx,gridData,options,plot){var i;var opts=(options!=undefined)?options:{};var shadow=(opts.shadow!=undefined)?opts.shadow:this.shadow;var showLine=(opts.showLine!=undefined)?opts.showLine:this.showLine;var fill=(opts.fill!=undefined)?opts.fill:this.fill;var xaxis=this.xaxis;var yaxis=this.yaxis;var xp=this._xaxis.series_u2p;var yp=this._yaxis.series_u2p;var pointx,points,pointy,nvals,nseries,pos;if(this._stack&&this.shadow){if(this.barWidth==null){this.renderer.setBarWidth.call(this);}
var temp=this._plotSeriesInfo=this.renderer.calcSeriesNumbers.call(this);nvals=temp[0];nseries=temp[1];pos=temp[2];if(this._stack){this._barNudge=0;}
else{this._barNudge=(-Math.abs(nseries/2-0.5)+pos)*(this.barWidth+this.barPadding);}
if(showLine){if(this.barDirection=='vertical'){for(var i=0;i<gridData.length;i++){if(this.data[i][1]==null){continue;}
points=[];var base=gridData[i][0]+this._barNudge;var ystart;if(this._stack&&this._prevGridData.length){ystart=getStart(this.index,i,this._plotData[i][1],plot,'y');}
else{if(this.fillToZero){ystart=this._yaxis.series_u2p(0);}
else{ystart=ctx.canvas.height;}}
points.push([base-this.barWidth/2,ystart]);points.push([base-this.barWidth/2,gridData[i][1]]);points.push([base+this.barWidth/2,gridData[i][1]]);points.push([base+this.barWidth/2,ystart]);this.renderer.shadowRenderer.draw(ctx,points,opts);}}
else if(this.barDirection=='horizontal'){for(var i=0;i<gridData.length;i++){if(this.data[i][0]==null){continue;}
points=[];var base=gridData[i][1]-this._barNudge;var xstart;if(this._stack&&this._prevGridData.length){xstart=getStart(this.index,i,this._plotData[i][0],plot,'x');}
else{if(this.fillToZero){xstart=this._xaxis.series_u2p(0);}
else{xstart=0;}}
points.push([xstart,base+this.barWidth/2]);points.push([gridData[i][0],base+this.barWidth/2]);points.push([gridData[i][0],base-this.barWidth/2]);points.push([xstart,base-this.barWidth/2]);this.renderer.shadowRenderer.draw(ctx,points,opts);}}}}};function postInit(target,data,options){for(var i=0;i<this.series.length;i++){if(this.series[i].renderer.constructor==$.jqplot.BarRenderer){if(this.series[i].highlightMouseOver){this.series[i].highlightMouseDown=false;}}}}
function postPlotDraw(){if(this.plugins.barRenderer&&this.plugins.barRenderer.highlightCanvas){this.plugins.barRenderer.highlightCanvas.resetCanvas();this.plugins.barRenderer.highlightCanvas=null;}
this.plugins.barRenderer={highlightedSeriesIndex:null};this.plugins.barRenderer.highlightCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.barRenderer.highlightCanvas.createElement(this._gridPadding,'jqplot-barRenderer-highlight-canvas',this._plotDimensions,this));this.plugins.barRenderer.highlightCanvas.setContext();this.eventCanvas._elem.bind('mouseleave',{plot:this},function(ev){unhighlight(ev.data.plot);});}
function highlight(plot,sidx,pidx,points){var s=plot.series[sidx];var canvas=plot.plugins.barRenderer.highlightCanvas;canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width,canvas._ctx.canvas.height);s._highlightedPoint=pidx;plot.plugins.barRenderer.highlightedSeriesIndex=sidx;var opts={fillStyle:s.highlightColors[pidx]};s.renderer.shapeRenderer.draw(canvas._ctx,points,opts);canvas=null;}
function unhighlight(plot){var canvas=plot.plugins.barRenderer.highlightCanvas;canvas._ctx.clearRect(0,0,canvas._ctx.canvas.width,canvas._ctx.canvas.height);for(var i=0;i<plot.series.length;i++){plot.series[i]._highlightedPoint=null;}
plot.plugins.barRenderer.highlightedSeriesIndex=null;plot.target.trigger('jqplotDataUnhighlight');canvas=null;}
function handleMove(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var evt1=jQuery.Event('jqplotDataMouseOver');evt1.pageX=ev.pageX;evt1.pageY=ev.pageY;plot.target.trigger(evt1,ins);if(plot.series[ins[0]].show&&plot.series[ins[0]].highlightMouseOver&&!(ins[0]==plot.plugins.barRenderer.highlightedSeriesIndex&&ins[1]==plot.series[ins[0]]._highlightedPoint)){var evt=jQuery.Event('jqplotDataHighlight');evt.which=ev.which;evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);highlight(plot,neighbor.seriesIndex,neighbor.pointIndex,neighbor.points);}}
else if(neighbor==null){unhighlight(plot);}}
function handleMouseDown(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];if(plot.series[ins[0]].highlightMouseDown&&!(ins[0]==plot.plugins.barRenderer.highlightedSeriesIndex&&ins[1]==plot.series[ins[0]]._highlightedPoint)){var evt=jQuery.Event('jqplotDataHighlight');evt.which=ev.which;evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);highlight(plot,neighbor.seriesIndex,neighbor.pointIndex,neighbor.points);}}
else if(neighbor==null){unhighlight(plot);}}
function handleMouseUp(ev,gridpos,datapos,neighbor,plot){var idx=plot.plugins.barRenderer.highlightedSeriesIndex;if(idx!=null&&plot.series[idx].highlightMouseDown){unhighlight(plot);}}
function handleClick(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var evt=jQuery.Event('jqplotDataClick');evt.which=ev.which;evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);}}
function handleRightClick(ev,gridpos,datapos,neighbor,plot){if(neighbor){var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data];var idx=plot.plugins.barRenderer.highlightedSeriesIndex;if(idx!=null&&plot.series[idx].highlightMouseDown){unhighlight(plot);}
var evt=jQuery.Event('jqplotDataRightClick');evt.which=ev.which;evt.pageX=ev.pageX;evt.pageY=ev.pageY;plot.target.trigger(evt,ins);}}})(jQuery);(function($){$.jqplot.CategoryAxisRenderer=function(options){$.jqplot.LinearAxisRenderer.call(this);this.sortMergedLabels=false;};$.jqplot.CategoryAxisRenderer.prototype=new $.jqplot.LinearAxisRenderer();$.jqplot.CategoryAxisRenderer.prototype.constructor=$.jqplot.CategoryAxisRenderer;$.jqplot.CategoryAxisRenderer.prototype.init=function(options){this.groups=1;this.groupLabels=[];this._groupLabels=[];this._grouped=false;this._barsPerGroup=null;this.reverse=false;$.extend(true,this,{tickOptions:{formatString:'%d'}},options);var db=this._dataBounds;for(var i=0;i<this._series.length;i++){var s=this._series[i];if(s.groups){this.groups=s.groups;}
var d=s.data;for(var j=0;j<d.length;j++){if(this.name=='xaxis'||this.name=='x2axis'){if(d[j][0]<db.min||db.min==null){db.min=d[j][0];}
if(d[j][0]>db.max||db.max==null){db.max=d[j][0];}}
else{if(d[j][1]<db.min||db.min==null){db.min=d[j][1];}
if(d[j][1]>db.max||db.max==null){db.max=d[j][1];}}}}
if(this.groupLabels.length){this.groups=this.groupLabels.length;}};$.jqplot.CategoryAxisRenderer.prototype.createTicks=function(){var ticks=this._ticks;var userTicks=this.ticks;var name=this.name;var db=this._dataBounds;var dim,interval;var min,max;var pos1,pos2;var tt,i;if(userTicks.length){if(this.groups>1&&!this._grouped){var l=userTicks.length;var skip=parseInt(l/this.groups,10);var count=0;for(var i=skip;i<l;i+=skip){userTicks.splice(i+count,0,' ');count++;}
this._grouped=true;}
this.min=0.5;this.max=userTicks.length+0.5;var range=this.max-this.min;this.numberTicks=2*userTicks.length+1;for(i=0;i<userTicks.length;i++){tt=this.min+2*i*range/(this.numberTicks-1);var t=new this.tickRenderer(this.tickOptions);t.showLabel=false;t.setTick(tt,this.name);this._ticks.push(t);var t=new this.tickRenderer(this.tickOptions);t.label=userTicks[i];t.showMark=false;t.showGridline=false;t.setTick(tt+0.5,this.name);this._ticks.push(t);}
var t=new this.tickRenderer(this.tickOptions);t.showLabel=false;t.setTick(tt+1,this.name);this._ticks.push(t);}
else{if(name=='xaxis'||name=='x2axis'){dim=this._plotDimensions.width;}
else{dim=this._plotDimensions.height;}
if(this.min!=null&&this.max!=null&&this.numberTicks!=null){this.tickInterval=null;}
if(this.min!=null&&this.max!=null&&this.tickInterval!=null){if(parseInt((this.max-this.min)/this.tickInterval,10)!=(this.max-this.min)/this.tickInterval){this.tickInterval=null;}}
var labels=[];var numcats=0;var min=0.5;var max,val;var isMerged=false;for(var i=0;i<this._series.length;i++){var s=this._series[i];for(var j=0;j<s.data.length;j++){if(this.name=='xaxis'||this.name=='x2axis'){val=s.data[j][0];}
else{val=s.data[j][1];}
if($.inArray(val,labels)==-1){isMerged=true;numcats+=1;labels.push(val);}}}
if(isMerged&&this.sortMergedLabels){if(typeof labels[0]=="string"){labels.sort();}else{labels.sort(function(a,b){return a-b;});}}
this.ticks=labels;for(var i=0;i<this._series.length;i++){var s=this._series[i];for(var j=0;j<s.data.length;j++){if(this.name=='xaxis'||this.name=='x2axis'){val=s.data[j][0];}
else{val=s.data[j][1];}
var idx=$.inArray(val,labels)+1;if(this.name=='xaxis'||this.name=='x2axis'){s.data[j][0]=idx;}
else{s.data[j][1]=idx;}}}
if(this.groups>1&&!this._grouped){var l=labels.length;var skip=parseInt(l/this.groups,10);var count=0;for(var i=skip;i<l;i+=skip+1){labels[i]=' ';}
this._grouped=true;}
max=numcats+0.5;if(this.numberTicks==null){this.numberTicks=2*numcats+1;}
var range=max-min;this.min=min;this.max=max;var track=0;var maxVisibleTicks=parseInt(3+dim/10,10);var skip=parseInt(numcats/maxVisibleTicks,10);if(this.tickInterval==null){this.tickInterval=range/(this.numberTicks-1);}
for(var i=0;i<this.numberTicks;i++){tt=this.min+i*this.tickInterval;var t=new this.tickRenderer(this.tickOptions);if(i/2==parseInt(i/2,10)){t.showLabel=false;t.showMark=true;}
else{if(skip>0&&track<skip){t.showLabel=false;track+=1;}
else{t.showLabel=true;track=0;}
t.label=t.formatter(t.formatString,labels[(i-1)/2]);t.showMark=false;t.showGridline=false;}
t.setTick(tt,this.name);this._ticks.push(t);}}};$.jqplot.CategoryAxisRenderer.prototype.draw=function(ctx,plot){if(this.show){this.renderer.createTicks.call(this);var dim=0;var temp;if(this._elem){this._elem.emptyForce();}
this._elem=this._elem||$('<div class="jqplot-axis jqplot-'+this.name+'" style="position:absolute;"></div>');if(this.name=='xaxis'||this.name=='x2axis'){this._elem.width(this._plotDimensions.width);}
else{this._elem.height(this._plotDimensions.height);}
this.labelOptions.axis=this.name;this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){var elem=this._label.draw(ctx,plot);elem.appendTo(this._elem);}
var t=this._ticks;for(var i=0;i<t.length;i++){var tick=t[i];if(tick.showLabel&&(!tick.isMinorTick||this.showMinorTicks)){var elem=tick.draw(ctx,plot);elem.appendTo(this._elem);}}
this._groupLabels=[];for(var i=0;i<this.groupLabels.length;i++)
{var elem=$('<div style="position:absolute;" class="jqplot-'+this.name+'-groupLabel"></div>');elem.html(this.groupLabels[i]);this._groupLabels.push(elem);elem.appendTo(this._elem);}}
return this._elem;};$.jqplot.CategoryAxisRenderer.prototype.set=function(){var dim=0;var temp;var w=0;var h=0;var lshow=(this._label==null)?false:this._label.show;if(this.show){var t=this._ticks;for(var i=0;i<t.length;i++){var tick=t[i];if(tick.showLabel&&(!tick.isMinorTick||this.showMinorTicks)){if(this.name=='xaxis'||this.name=='x2axis'){temp=tick._elem.outerHeight(true);}
else{temp=tick._elem.outerWidth(true);}
if(temp>dim){dim=temp;}}}
var dim2=0;for(var i=0;i<this._groupLabels.length;i++){var l=this._groupLabels[i];if(this.name=='xaxis'||this.name=='x2axis'){temp=l.outerHeight(true);}
else{temp=l.outerWidth(true);}
if(temp>dim2){dim2=temp;}}
if(lshow){w=this._label._elem.outerWidth(true);h=this._label._elem.outerHeight(true);}
if(this.name=='xaxis'){dim+=dim2+h;this._elem.css({'height':dim+'px',left:'0px',bottom:'0px'});}
else if(this.name=='x2axis'){dim+=dim2+h;this._elem.css({'height':dim+'px',left:'0px',top:'0px'});}
else if(this.name=='yaxis'){dim+=dim2+w;this._elem.css({'width':dim+'px',left:'0px',top:'0px'});if(lshow&&this._label.constructor==$.jqplot.AxisLabelRenderer){this._label._elem.css('width',w+'px');}}
else{dim+=dim2+w;this._elem.css({'width':dim+'px',right:'0px',top:'0px'});if(lshow&&this._label.constructor==$.jqplot.AxisLabelRenderer){this._label._elem.css('width',w+'px');}}}};$.jqplot.CategoryAxisRenderer.prototype.pack=function(pos,offsets){var ticks=this._ticks;var max=this.max;var min=this.min;var offmax=offsets.max;var offmin=offsets.min;var lshow=(this._label==null)?false:this._label.show;var i;for(var p in pos){this._elem.css(p,pos[p]);}
this._offsets=offsets;var pixellength=offmax-offmin;var unitlength=max-min;if(!this.reverse){this.u2p=function(u){return(u-min)*pixellength/unitlength+offmin;};this.p2u=function(p){return(p-offmin)*unitlength/pixellength+min;};if(this.name=='xaxis'||this.name=='x2axis'){this.series_u2p=function(u){return(u-min)*pixellength/unitlength;};this.series_p2u=function(p){return p*unitlength/pixellength+min;};}
else{this.series_u2p=function(u){return(u-max)*pixellength/unitlength;};this.series_p2u=function(p){return p*unitlength/pixellength+max;};}}
else{this.u2p=function(u){return offmin+(max-u)*pixellength/unitlength;};this.p2u=function(p){return min+(p-offmin)*unitlength/pixellength;};if(this.name=='xaxis'||this.name=='x2axis'){this.series_u2p=function(u){return(max-u)*pixellength/unitlength;};this.series_p2u=function(p){return p*unitlength/pixellength+max;};}
else{this.series_u2p=function(u){return(min-u)*pixellength/unitlength;};this.series_p2u=function(p){return p*unitlength/pixellength+min;};}}
if(this.show){if(this.name=='xaxis'||this.name=='x2axis'){for(i=0;i<ticks.length;i++){var t=ticks[i];if(t.show&&t.showLabel){var shim;if(t.constructor==$.jqplot.CanvasAxisTickRenderer&&t.angle){var temp=(this.name=='xaxis')?1:-1;switch(t.labelPosition){case'auto':if(temp*t.angle<0){shim=-t.getWidth()+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;}
else{shim=-t._textRenderer.height*Math.sin(t._textRenderer.angle)/2;}
break;case'end':shim=-t.getWidth()+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break;case'start':shim=-t._textRenderer.height*Math.sin(t._textRenderer.angle)/2;break;case'middle':shim=-t.getWidth()/2+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break;default:shim=-t.getWidth()/2+t._textRenderer.height*Math.sin(-t._textRenderer.angle)/2;break;}}
else{shim=-t.getWidth()/2;}
var val=this.u2p(t.value)+shim+'px';t._elem.css('left',val);t.pack();}}
var labeledge=['bottom',0];if(lshow){var w=this._label._elem.outerWidth(true);this._label._elem.css('left',offmin+pixellength/2-w/2+'px');if(this.name=='xaxis'){this._label._elem.css('bottom','0px');labeledge=['bottom',this._label._elem.outerHeight(true)];}
else{this._label._elem.css('top','0px');labeledge=['top',this._label._elem.outerHeight(true)];}
this._label.pack();}
var step=parseInt(this._ticks.length/this.groups,10)+1;for(i=0;i<this._groupLabels.length;i++){var mid=0;var count=0;for(var j=i*step;j<(i+1)*step;j++){if(j>=this._ticks.length-1)continue;if(this._ticks[j]._elem&&this._ticks[j].label!=" "){var t=this._ticks[j]._elem;var p=t.position();mid+=p.left+t.outerWidth(true)/2;count++;}}
mid=mid/count;this._groupLabels[i].css({'left':(mid-this._groupLabels[i].outerWidth(true)/2)});this._groupLabels[i].css(labeledge[0],labeledge[1]);}}
else{for(i=0;i<ticks.length;i++){var t=ticks[i];if(t.show&&t.showLabel){var shim;if(t.constructor==$.jqplot.CanvasAxisTickRenderer&&t.angle){var temp=(this.name=='yaxis')?1:-1;switch(t.labelPosition){case'auto':case'end':if(temp*t.angle<0){shim=-t._textRenderer.height*Math.cos(-t._textRenderer.angle)/2;}
else{shim=-t.getHeight()+t._textRenderer.height*Math.cos(t._textRenderer.angle)/2;}
break;case'start':if(t.angle>0){shim=-t._textRenderer.height*Math.cos(-t._textRenderer.angle)/2;}
else{shim=-t.getHeight()+t._textRenderer.height*Math.cos(t._textRenderer.angle)/2;}
break;case'middle':shim=-t.getHeight()/2;break;default:shim=-t.getHeight()/2;break;}}
else{shim=-t.getHeight()/2;}
var val=this.u2p(t.value)+shim+'px';t._elem.css('top',val);t.pack();}}
var labeledge=['left',0];if(lshow){var h=this._label._elem.outerHeight(true);this._label._elem.css('top',offmax-pixellength/2-h/2+'px');if(this.name=='yaxis'){this._label._elem.css('left','0px');labeledge=['left',this._label._elem.outerWidth(true)];}
else{this._label._elem.css('right','0px');labeledge=['right',this._label._elem.outerWidth(true)];}
this._label.pack();}
var step=parseInt(this._ticks.length/this.groups,10)+1;for(i=0;i<this._groupLabels.length;i++){var mid=0;var count=0;for(var j=i*step;j<(i+1)*step;j++){if(j>=this._ticks.length-1)continue;if(this._ticks[j]._elem&&this._ticks[j].label!=" "){var t=this._ticks[j]._elem;var p=t.position();mid+=p.top+t.outerHeight()/2;count++;}}
mid=mid/count;this._groupLabels[i].css({'top':mid-this._groupLabels[i].outerHeight()/2});this._groupLabels[i].css(labeledge[0],labeledge[1]);}}}};})(jQuery);(function($){$.jqplot.AxisLabelRenderer=function(options){$.jqplot.ElemContainer.call(this);this.axis;this.show=true;this.label='';this.fontFamily=null;this.fontSize=null;this.textColor=null;this._elem;this.escapeHTML=false;$.extend(true,this,options);};$.jqplot.AxisLabelRenderer.prototype=new $.jqplot.ElemContainer();$.jqplot.AxisLabelRenderer.prototype.constructor=$.jqplot.AxisLabelRenderer;$.jqplot.AxisLabelRenderer.prototype.init=function(options){$.extend(true,this,options);};$.jqplot.AxisLabelRenderer.prototype.draw=function(ctx,plot){if(this._elem){this._elem.emptyForce();this._elem=null;}
this._elem=$('<div style="position:absolute;" class="jqplot-'+this.axis+'-label"></div>');if(Number(this.label)){this._elem.css('white-space','nowrap');}
if(!this.escapeHTML){this._elem.html(this.label);}
else{this._elem.text(this.label);}
if(this.fontFamily){this._elem.css('font-family',this.fontFamily);}
if(this.fontSize){this._elem.css('font-size',this.fontSize);}
if(this.textColor){this._elem.css('color',this.textColor);}
return this._elem;};$.jqplot.AxisLabelRenderer.prototype.pack=function(){};})(jQuery);(function($){$.jqplot.CanvasTextRenderer=function(options){this.fontStyle='normal';this.fontVariant='normal';this.fontWeight='normal';this.fontSize='10px';this.fontFamily='sans-serif';this.fontStretch=1.0;this.fillStyle='#666666';this.angle=0;this.textAlign='start';this.textBaseline='alphabetic';this.text;this.width;this.height;this.pt2px=1.28;$.extend(true,this,options);this.normalizedFontSize=this.normalizeFontSize(this.fontSize);this.setHeight();};$.jqplot.CanvasTextRenderer.prototype.init=function(options){$.extend(true,this,options);this.normalizedFontSize=this.normalizeFontSize(this.fontSize);this.setHeight();};$.jqplot.CanvasTextRenderer.prototype.normalizeFontSize=function(sz){sz=String(sz);var n=parseFloat(sz);if(sz.indexOf('px')>-1){return n/this.pt2px;}
else if(sz.indexOf('pt')>-1){return n;}
else if(sz.indexOf('em')>-1){return n*12;}
else if(sz.indexOf('%')>-1){return n*12/100;}
else{return n/this.pt2px;}};$.jqplot.CanvasTextRenderer.prototype.fontWeight2Float=function(w){if(Number(w)){return w/400;}
else{switch(w){case'normal':return 1;break;case'bold':return 1.75;break;case'bolder':return 2.25;break;case'lighter':return 0.75;break;default:return 1;break;}}};$.jqplot.CanvasTextRenderer.prototype.getText=function(){return this.text;};$.jqplot.CanvasTextRenderer.prototype.setText=function(t,ctx){this.text=t;this.setWidth(ctx);return this;};$.jqplot.CanvasTextRenderer.prototype.getWidth=function(ctx){return this.width;};$.jqplot.CanvasTextRenderer.prototype.setWidth=function(ctx,w){if(!w){this.width=this.measure(ctx,this.text);}
else{this.width=w;}
return this;};$.jqplot.CanvasTextRenderer.prototype.getHeight=function(ctx){return this.height;};$.jqplot.CanvasTextRenderer.prototype.setHeight=function(w){if(!w){this.height=this.normalizedFontSize*this.pt2px;}
else{this.height=w;}
return this;};$.jqplot.CanvasTextRenderer.prototype.letter=function(ch)
{return this.letters[ch];};$.jqplot.CanvasTextRenderer.prototype.ascent=function()
{return this.normalizedFontSize;};$.jqplot.CanvasTextRenderer.prototype.descent=function()
{return 7.0*this.normalizedFontSize/25.0;};$.jqplot.CanvasTextRenderer.prototype.measure=function(ctx,str)
{var total=0;var len=str.length;for(var i=0;i<len;i++){var c=this.letter(str.charAt(i));if(c){total+=c.width*this.normalizedFontSize/25.0*this.fontStretch;}}
return total;};$.jqplot.CanvasTextRenderer.prototype.draw=function(ctx,str)
{var x=0;var y=this.height*0.72;var total=0;var len=str.length;var mag=this.normalizedFontSize/25.0;ctx.save();var tx,ty;if((-Math.PI/2<=this.angle&&this.angle<=0)||(Math.PI*3/2<=this.angle&&this.angle<=Math.PI*2)){tx=0;ty=-Math.sin(this.angle)*this.width;}
else if((0<this.angle&&this.angle<=Math.PI/2)||(-Math.PI*2<=this.angle&&this.angle<=-Math.PI*3/2)){tx=Math.sin(this.angle)*this.height;ty=0;}
else if((-Math.PI<this.angle&&this.angle<-Math.PI/2)||(Math.PI<=this.angle&&this.angle<=Math.PI*3/2)){tx=-Math.cos(this.angle)*this.width;ty=-Math.sin(this.angle)*this.width-Math.cos(this.angle)*this.height;}
else if((-Math.PI*3/2<this.angle&&this.angle<Math.PI)||(Math.PI/2<this.angle&&this.angle<Math.PI)){tx=Math.sin(this.angle)*this.height-Math.cos(this.angle)*this.width;ty=-Math.cos(this.angle)*this.height;}
ctx.strokeStyle=this.fillStyle;ctx.fillStyle=this.fillStyle;ctx.translate(tx,ty);ctx.rotate(this.angle);ctx.lineCap="round";var fact=(this.normalizedFontSize>30)?2.0:2+(30-this.normalizedFontSize)/20;ctx.lineWidth=fact*mag*this.fontWeight2Float(this.fontWeight);for(var i=0;i<len;i++){var c=this.letter(str.charAt(i));if(!c){continue;}
ctx.beginPath();var penUp=1;var needStroke=0;for(var j=0;j<c.points.length;j++){var a=c.points[j];if(a[0]==-1&&a[1]==-1){penUp=1;continue;}
if(penUp){ctx.moveTo(x+a[0]*mag*this.fontStretch,y-a[1]*mag);penUp=false;}else{ctx.lineTo(x+a[0]*mag*this.fontStretch,y-a[1]*mag);}}
ctx.stroke();x+=c.width*mag*this.fontStretch;}
ctx.restore();return total;};$.jqplot.CanvasTextRenderer.prototype.letters={' ':{width:16,points:[]},'!':{width:10,points:[[5,21],[5,7],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},'"':{width:16,points:[[4,21],[4,14],[-1,-1],[12,21],[12,14]]},'#':{width:21,points:[[11,25],[4,-7],[-1,-1],[17,25],[10,-7],[-1,-1],[4,12],[18,12],[-1,-1],[3,6],[17,6]]},'$':{width:20,points:[[8,25],[8,-4],[-1,-1],[12,25],[12,-4],[-1,-1],[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},'%':{width:24,points:[[21,21],[3,0],[-1,-1],[8,21],[10,19],[10,17],[9,15],[7,14],[5,14],[3,16],[3,18],[4,20],[6,21],[8,21],[10,20],[13,19],[16,19],[19,20],[21,21],[-1,-1],[17,7],[15,6],[14,4],[14,2],[16,0],[18,0],[20,1],[21,3],[21,5],[19,7],[17,7]]},'&':{width:26,points:[[23,12],[23,13],[22,14],[21,14],[20,13],[19,11],[17,6],[15,3],[13,1],[11,0],[7,0],[5,1],[4,2],[3,4],[3,6],[4,8],[5,9],[12,13],[13,14],[14,16],[14,18],[13,20],[11,21],[9,20],[8,18],[8,16],[9,13],[11,10],[16,3],[18,1],[20,0],[22,0],[23,1],[23,2]]},'\'':{width:10,points:[[5,19],[4,20],[5,21],[6,20],[6,18],[5,16],[4,15]]},'(':{width:14,points:[[11,25],[9,23],[7,20],[5,16],[4,11],[4,7],[5,2],[7,-2],[9,-5],[11,-7]]},')':{width:14,points:[[3,25],[5,23],[7,20],[9,16],[10,11],[10,7],[9,2],[7,-2],[5,-5],[3,-7]]},'*':{width:16,points:[[8,21],[8,9],[-1,-1],[3,18],[13,12],[-1,-1],[13,18],[3,12]]},'+':{width:26,points:[[13,18],[13,0],[-1,-1],[4,9],[22,9]]},',':{width:10,points:[[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},'-':{width:18,points:[[6,9],[12,9]]},'.':{width:10,points:[[5,2],[4,1],[5,0],[6,1],[5,2]]},'/':{width:22,points:[[20,25],[2,-7]]},'0':{width:20,points:[[9,21],[6,20],[4,17],[3,12],[3,9],[4,4],[6,1],[9,0],[11,0],[14,1],[16,4],[17,9],[17,12],[16,17],[14,20],[11,21],[9,21]]},'1':{width:20,points:[[6,17],[8,18],[11,21],[11,0]]},'2':{width:20,points:[[4,16],[4,17],[5,19],[6,20],[8,21],[12,21],[14,20],[15,19],[16,17],[16,15],[15,13],[13,10],[3,0],[17,0]]},'3':{width:20,points:[[5,21],[16,21],[10,13],[13,13],[15,12],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},'4':{width:20,points:[[13,21],[3,7],[18,7],[-1,-1],[13,21],[13,0]]},'5':{width:20,points:[[15,21],[5,21],[4,12],[5,13],[8,14],[11,14],[14,13],[16,11],[17,8],[17,6],[16,3],[14,1],[11,0],[8,0],[5,1],[4,2],[3,4]]},'6':{width:20,points:[[16,18],[15,20],[12,21],[10,21],[7,20],[5,17],[4,12],[4,7],[5,3],[7,1],[10,0],[11,0],[14,1],[16,3],[17,6],[17,7],[16,10],[14,12],[11,13],[10,13],[7,12],[5,10],[4,7]]},'7':{width:20,points:[[17,21],[7,0],[-1,-1],[3,21],[17,21]]},'8':{width:20,points:[[8,21],[5,20],[4,18],[4,16],[5,14],[7,13],[11,12],[14,11],[16,9],[17,7],[17,4],[16,2],[15,1],[12,0],[8,0],[5,1],[4,2],[3,4],[3,7],[4,9],[6,11],[9,12],[13,13],[15,14],[16,16],[16,18],[15,20],[12,21],[8,21]]},'9':{width:20,points:[[16,14],[15,11],[13,9],[10,8],[9,8],[6,9],[4,11],[3,14],[3,15],[4,18],[6,20],[9,21],[10,21],[13,20],[15,18],[16,14],[16,9],[15,4],[13,1],[10,0],[8,0],[5,1],[4,3]]},':':{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[5,2],[4,1],[5,0],[6,1],[5,2]]},';':{width:10,points:[[5,14],[4,13],[5,12],[6,13],[5,14],[-1,-1],[6,1],[5,0],[4,1],[5,2],[6,1],[6,-1],[5,-3],[4,-4]]},'<':{width:24,points:[[20,18],[4,9],[20,0]]},'=':{width:26,points:[[4,12],[22,12],[-1,-1],[4,6],[22,6]]},'>':{width:24,points:[[4,18],[20,9],[4,0]]},'?':{width:18,points:[[3,16],[3,17],[4,19],[5,20],[7,21],[11,21],[13,20],[14,19],[15,17],[15,15],[14,13],[13,12],[9,10],[9,7],[-1,-1],[9,2],[8,1],[9,0],[10,1],[9,2]]},'@':{width:27,points:[[18,13],[17,15],[15,16],[12,16],[10,15],[9,14],[8,11],[8,8],[9,6],[11,5],[14,5],[16,6],[17,8],[-1,-1],[12,16],[10,14],[9,11],[9,8],[10,6],[11,5],[-1,-1],[18,16],[17,8],[17,6],[19,5],[21,5],[23,7],[24,10],[24,12],[23,15],[22,17],[20,19],[18,20],[15,21],[12,21],[9,20],[7,19],[5,17],[4,15],[3,12],[3,9],[4,6],[5,4],[7,2],[9,1],[12,0],[15,0],[18,1],[20,2],[21,3],[-1,-1],[19,16],[18,8],[18,6],[19,5]]},'A':{width:18,points:[[9,21],[1,0],[-1,-1],[9,21],[17,0],[-1,-1],[4,7],[14,7]]},'B':{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[-1,-1],[4,11],[13,11],[16,10],[17,9],[18,7],[18,4],[17,2],[16,1],[13,0],[4,0]]},'C':{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5]]},'D':{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[11,21],[14,20],[16,18],[17,16],[18,13],[18,8],[17,5],[16,3],[14,1],[11,0],[4,0]]},'E':{width:19,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11],[-1,-1],[4,0],[17,0]]},'F':{width:18,points:[[4,21],[4,0],[-1,-1],[4,21],[17,21],[-1,-1],[4,11],[12,11]]},'G':{width:21,points:[[18,16],[17,18],[15,20],[13,21],[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[18,8],[-1,-1],[13,8],[18,8]]},'H':{width:22,points:[[4,21],[4,0],[-1,-1],[18,21],[18,0],[-1,-1],[4,11],[18,11]]},'I':{width:8,points:[[4,21],[4,0]]},'J':{width:16,points:[[12,21],[12,5],[11,2],[10,1],[8,0],[6,0],[4,1],[3,2],[2,5],[2,7]]},'K':{width:21,points:[[4,21],[4,0],[-1,-1],[18,21],[4,7],[-1,-1],[9,12],[18,0]]},'L':{width:17,points:[[4,21],[4,0],[-1,-1],[4,0],[16,0]]},'M':{width:24,points:[[4,21],[4,0],[-1,-1],[4,21],[12,0],[-1,-1],[20,21],[12,0],[-1,-1],[20,21],[20,0]]},'N':{width:22,points:[[4,21],[4,0],[-1,-1],[4,21],[18,0],[-1,-1],[18,21],[18,0]]},'O':{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21]]},'P':{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,14],[17,12],[16,11],[13,10],[4,10]]},'Q':{width:22,points:[[9,21],[7,20],[5,18],[4,16],[3,13],[3,8],[4,5],[5,3],[7,1],[9,0],[13,0],[15,1],[17,3],[18,5],[19,8],[19,13],[18,16],[17,18],[15,20],[13,21],[9,21],[-1,-1],[12,4],[18,-2]]},'R':{width:21,points:[[4,21],[4,0],[-1,-1],[4,21],[13,21],[16,20],[17,19],[18,17],[18,15],[17,13],[16,12],[13,11],[4,11],[-1,-1],[11,11],[18,0]]},'S':{width:20,points:[[17,18],[15,20],[12,21],[8,21],[5,20],[3,18],[3,16],[4,14],[5,13],[7,12],[13,10],[15,9],[16,8],[17,6],[17,3],[15,1],[12,0],[8,0],[5,1],[3,3]]},'T':{width:16,points:[[8,21],[8,0],[-1,-1],[1,21],[15,21]]},'U':{width:22,points:[[4,21],[4,6],[5,3],[7,1],[10,0],[12,0],[15,1],[17,3],[18,6],[18,21]]},'V':{width:18,points:[[1,21],[9,0],[-1,-1],[17,21],[9,0]]},'W':{width:24,points:[[2,21],[7,0],[-1,-1],[12,21],[7,0],[-1,-1],[12,21],[17,0],[-1,-1],[22,21],[17,0]]},'X':{width:20,points:[[3,21],[17,0],[-1,-1],[17,21],[3,0]]},'Y':{width:18,points:[[1,21],[9,11],[9,0],[-1,-1],[17,21],[9,11]]},'Z':{width:20,points:[[17,21],[3,0],[-1,-1],[3,21],[17,21],[-1,-1],[3,0],[17,0]]},'[':{width:14,points:[[4,25],[4,-7],[-1,-1],[5,25],[5,-7],[-1,-1],[4,25],[11,25],[-1,-1],[4,-7],[11,-7]]},'\\':{width:14,points:[[0,21],[14,-3]]},']':{width:14,points:[[9,25],[9,-7],[-1,-1],[10,25],[10,-7],[-1,-1],[3,25],[10,25],[-1,-1],[3,-7],[10,-7]]},'^':{width:16,points:[[6,15],[8,18],[10,15],[-1,-1],[3,12],[8,17],[13,12],[-1,-1],[8,17],[8,0]]},'_':{width:16,points:[[0,-2],[16,-2]]},'`':{width:10,points:[[6,21],[5,20],[4,18],[4,16],[5,15],[6,16],[5,17]]},'a':{width:19,points:[[15,14],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},'b':{width:19,points:[[4,21],[4,0],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},'c':{width:18,points:[[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},'d':{width:19,points:[[15,21],[15,0],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},'e':{width:18,points:[[3,8],[15,8],[15,10],[14,12],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},'f':{width:12,points:[[10,21],[8,21],[6,20],[5,17],[5,0],[-1,-1],[2,14],[9,14]]},'g':{width:19,points:[[15,14],[15,-2],[14,-5],[13,-6],[11,-7],[8,-7],[6,-6],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},'h':{width:19,points:[[4,21],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},'i':{width:8,points:[[3,21],[4,20],[5,21],[4,22],[3,21],[-1,-1],[4,14],[4,0]]},'j':{width:10,points:[[5,21],[6,20],[7,21],[6,22],[5,21],[-1,-1],[6,14],[6,-3],[5,-6],[3,-7],[1,-7]]},'k':{width:17,points:[[4,21],[4,0],[-1,-1],[14,14],[4,4],[-1,-1],[8,8],[15,0]]},'l':{width:8,points:[[4,21],[4,0]]},'m':{width:30,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0],[-1,-1],[15,10],[18,13],[20,14],[23,14],[25,13],[26,10],[26,0]]},'n':{width:19,points:[[4,14],[4,0],[-1,-1],[4,10],[7,13],[9,14],[12,14],[14,13],[15,10],[15,0]]},'o':{width:19,points:[[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3],[16,6],[16,8],[15,11],[13,13],[11,14],[8,14]]},'p':{width:19,points:[[4,14],[4,-7],[-1,-1],[4,11],[6,13],[8,14],[11,14],[13,13],[15,11],[16,8],[16,6],[15,3],[13,1],[11,0],[8,0],[6,1],[4,3]]},'q':{width:19,points:[[15,14],[15,-7],[-1,-1],[15,11],[13,13],[11,14],[8,14],[6,13],[4,11],[3,8],[3,6],[4,3],[6,1],[8,0],[11,0],[13,1],[15,3]]},'r':{width:13,points:[[4,14],[4,0],[-1,-1],[4,8],[5,11],[7,13],[9,14],[12,14]]},'s':{width:17,points:[[14,11],[13,13],[10,14],[7,14],[4,13],[3,11],[4,9],[6,8],[11,7],[13,6],[14,4],[14,3],[13,1],[10,0],[7,0],[4,1],[3,3]]},'t':{width:12,points:[[5,21],[5,4],[6,1],[8,0],[10,0],[-1,-1],[2,14],[9,14]]},'u':{width:19,points:[[4,14],[4,4],[5,1],[7,0],[10,0],[12,1],[15,4],[-1,-1],[15,14],[15,0]]},'v':{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0]]},'w':{width:22,points:[[3,14],[7,0],[-1,-1],[11,14],[7,0],[-1,-1],[11,14],[15,0],[-1,-1],[19,14],[15,0]]},'x':{width:17,points:[[3,14],[14,0],[-1,-1],[14,14],[3,0]]},'y':{width:16,points:[[2,14],[8,0],[-1,-1],[14,14],[8,0],[6,-4],[4,-6],[2,-7],[1,-7]]},'z':{width:17,points:[[14,14],[3,0],[-1,-1],[3,14],[14,14],[-1,-1],[3,0],[14,0]]},'{':{width:14,points:[[9,25],[7,24],[6,23],[5,21],[5,19],[6,17],[7,16],[8,14],[8,12],[6,10],[-1,-1],[7,24],[6,22],[6,20],[7,18],[8,17],[9,15],[9,13],[8,11],[4,9],[8,7],[9,5],[9,3],[8,1],[7,0],[6,-2],[6,-4],[7,-6],[-1,-1],[6,8],[8,6],[8,4],[7,2],[6,1],[5,-1],[5,-3],[6,-5],[7,-6],[9,-7]]},'|':{width:8,points:[[4,25],[4,-7]]},'}':{width:14,points:[[5,25],[7,24],[8,23],[9,21],[9,19],[8,17],[7,16],[6,14],[6,12],[8,10],[-1,-1],[7,24],[8,22],[8,20],[7,18],[6,17],[5,15],[5,13],[6,11],[10,9],[6,7],[5,5],[5,3],[6,1],[7,0],[8,-2],[8,-4],[7,-6],[-1,-1],[8,8],[6,6],[6,4],[7,2],[8,1],[9,-1],[9,-3],[8,-5],[7,-6],[5,-7]]},'~':{width:24,points:[[3,6],[3,8],[4,11],[6,12],[8,12],[10,11],[14,8],[16,7],[18,7],[20,8],[21,10],[-1,-1],[3,8],[4,10],[6,11],[8,11],[10,10],[14,7],[16,6],[18,6],[20,7],[21,10],[21,12]]}};$.jqplot.CanvasFontRenderer=function(options){options=options||{};if(!options.pt2px){options.pt2px=1.5;}
$.jqplot.CanvasTextRenderer.call(this,options);};$.jqplot.CanvasFontRenderer.prototype=new $.jqplot.CanvasTextRenderer({});$.jqplot.CanvasFontRenderer.prototype.constructor=$.jqplot.CanvasFontRenderer;$.jqplot.CanvasFontRenderer.prototype.measure=function(ctx,str)
{var fstyle=this.fontSize+' '+this.fontFamily;ctx.save();ctx.font=fstyle;var w=ctx.measureText(str).width;ctx.restore();return w;};$.jqplot.CanvasFontRenderer.prototype.draw=function(ctx,str)
{var x=0;var y=this.height*0.72;ctx.save();var tx,ty;if((-Math.PI/2<=this.angle&&this.angle<=0)||(Math.PI*3/2<=this.angle&&this.angle<=Math.PI*2)){tx=0;ty=-Math.sin(this.angle)*this.width;}
else if((0<this.angle&&this.angle<=Math.PI/2)||(-Math.PI*2<=this.angle&&this.angle<=-Math.PI*3/2)){tx=Math.sin(this.angle)*this.height;ty=0;}
else if((-Math.PI<this.angle&&this.angle<-Math.PI/2)||(Math.PI<=this.angle&&this.angle<=Math.PI*3/2)){tx=-Math.cos(this.angle)*this.width;ty=-Math.sin(this.angle)*this.width-Math.cos(this.angle)*this.height;}
else if((-Math.PI*3/2<this.angle&&this.angle<Math.PI)||(Math.PI/2<this.angle&&this.angle<Math.PI)){tx=Math.sin(this.angle)*this.height-Math.cos(this.angle)*this.width;ty=-Math.cos(this.angle)*this.height;}
ctx.strokeStyle=this.fillStyle;ctx.fillStyle=this.fillStyle;var fstyle=this.fontSize+' '+this.fontFamily;ctx.font=fstyle;ctx.translate(tx,ty);ctx.rotate(this.angle);ctx.fillText(str,x,y);ctx.restore();};})(jQuery);(function($){$.jqplot.CanvasAxisLabelRenderer=function(options){this.angle=0;this.axis;this.show=true;this.showLabel=true;this.label='';this.fontFamily='"Trebuchet MS", Arial, Helvetica, sans-serif';this.fontSize='11pt';this.fontWeight='normal';this.fontStretch=1.0;this.textColor='#666666';this.enableFontSupport=true;this.pt2px=null;this._elem;this._ctx;this._plotWidth;this._plotHeight;this._plotDimensions={height:null,width:null};$.extend(true,this,options);if(options.angle==null&&this.axis!='xaxis'&&this.axis!='x2axis'){this.angle=-90;}
var ropts={fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily};if(this.pt2px){ropts.pt2px=this.pt2px;}
if(this.enableFontSupport){if($.jqplot.support_canvas_text()){this._textRenderer=new $.jqplot.CanvasFontRenderer(ropts);}
else{this._textRenderer=new $.jqplot.CanvasTextRenderer(ropts);}}
else{this._textRenderer=new $.jqplot.CanvasTextRenderer(ropts);}};$.jqplot.CanvasAxisLabelRenderer.prototype.init=function(options){$.extend(true,this,options);this._textRenderer.init({fontSize:this.fontSize,fontWeight:this.fontWeight,fontStretch:this.fontStretch,fillStyle:this.textColor,angle:this.getAngleRad(),fontFamily:this.fontFamily});};$.jqplot.CanvasAxisLabelRenderer.prototype.getWidth=function(ctx){if(this._elem){return this._elem.outerWidth(true);}
else{var tr=this._textRenderer;var l=tr.getWidth(ctx);var h=tr.getHeight(ctx);var w=Math.abs(Math.sin(tr.angle)*h)+Math.abs(Math.cos(tr.angle)*l);return w;}};$.jqplot.CanvasAxisLabelRenderer.prototype.getHeight=function(ctx){if(this._elem){return this._elem.outerHeight(true);}
else{var tr=this._textRenderer;var l=tr.getWidth(ctx);var h=tr.getHeight(ctx);var w=Math.abs(Math.cos(tr.angle)*h)+Math.abs(Math.sin(tr.angle)*l);return w;}};$.jqplot.CanvasAxisLabelRenderer.prototype.getAngleRad=function(){var a=this.angle*Math.PI/180;return a;};$.jqplot.CanvasAxisLabelRenderer.prototype.draw=function(ctx,plot){if(this._elem){if($.jqplot.use_excanvas&&window.G_vmlCanvasManager.uninitElement!==undefined){window.G_vmlCanvasManager.uninitElement(this._elem.get(0));}
this._elem.emptyForce();this._elem=null;}
var elem=plot.canvasManager.getCanvas();this._textRenderer.setText(this.label,ctx);var w=this.getWidth(ctx);var h=this.getHeight(ctx);elem.width=w;elem.height=h;elem.style.width=w;elem.style.height=h;elem=plot.canvasManager.initCanvas(elem);this._elem=$(elem);this._elem.css({position:'absolute'});this._elem.addClass('jqplot-'+this.axis+'-label');elem=null;return this._elem;};$.jqplot.CanvasAxisLabelRenderer.prototype.pack=function(){this._textRenderer.draw(this._elem.get(0).getContext("2d"),this.label);};})(jQuery);(function($){$.jqplot.eventListenerHooks.push(['jqplotMouseMove',handleMove]);$.jqplot.Highlighter=function(options){this.show=$.jqplot.config.enablePlugins;this.markerRenderer=new $.jqplot.MarkerRenderer({shadow:false});this.showMarker=true;this.lineWidthAdjust=2.5;this.sizeAdjust=5;this.showTooltip=true;this.tooltipLocation='nw';this.fadeTooltip=true;this.tooltipFadeSpeed="fast";this.tooltipOffset=2;this.tooltipAxes='both';this.tooltipSeparator=', ';this.tooltipContentEditor=null;this.useAxesFormatters=true;this.tooltipFormatString='%.5P';this.formatString=null;this.yvalues=1;this.bringSeriesToFront=false;this._tooltipElem;this.isHighlighting=false;this.currentNeighbor=null;$.extend(true,this,options);};var locations=['nw','n','ne','e','se','s','sw','w'];var locationIndicies={'nw':0,'n':1,'ne':2,'e':3,'se':4,'s':5,'sw':6,'w':7};var oppositeLocations=['se','s','sw','w','nw','n','ne','e'];$.jqplot.Highlighter.init=function(target,data,opts){var options=opts||{};this.plugins.highlighter=new $.jqplot.Highlighter(options.highlighter);};$.jqplot.Highlighter.parseOptions=function(defaults,options){this.showHighlight=true;};$.jqplot.Highlighter.postPlotDraw=function(){if(this.plugins.highlighter&&this.plugins.highlighter.highlightCanvas){this.plugins.highlighter.highlightCanvas.resetCanvas();this.plugins.highlighter.highlightCanvas=null;}
if(this.plugins.highlighter&&this.plugins.highlighter._tooltipElem){this.plugins.highlighter._tooltipElem.emptyForce();this.plugins.highlighter._tooltipElem=null;}
this.plugins.highlighter.highlightCanvas=new $.jqplot.GenericCanvas();this.eventCanvas._elem.before(this.plugins.highlighter.highlightCanvas.createElement(this._gridPadding,'jqplot-highlight-canvas',this._plotDimensions,this));this.plugins.highlighter.highlightCanvas.setContext();var elem=document.createElement('div');this.plugins.highlighter._tooltipElem=$(elem);elem=null;this.plugins.highlighter._tooltipElem.addClass('jqplot-highlighter-tooltip');this.plugins.highlighter._tooltipElem.css({position:'absolute',display:'none'});this.eventCanvas._elem.before(this.plugins.highlighter._tooltipElem);};$.jqplot.preInitHooks.push($.jqplot.Highlighter.init);$.jqplot.preParseSeriesOptionsHooks.push($.jqplot.Highlighter.parseOptions);$.jqplot.postDrawHooks.push($.jqplot.Highlighter.postPlotDraw);function draw(plot,neighbor){var hl=plot.plugins.highlighter;var s=plot.series[neighbor.seriesIndex];var smr=s.markerRenderer;var mr=hl.markerRenderer;mr.style=smr.style;mr.lineWidth=smr.lineWidth+hl.lineWidthAdjust;mr.size=smr.size+hl.sizeAdjust;var rgba=$.jqplot.getColorComponents(smr.color);var newrgb=[rgba[0],rgba[1],rgba[2]];var alpha=(rgba[3]>=0.6)?rgba[3]*0.6:rgba[3]*(2-rgba[3]);mr.color='rgba('+newrgb[0]+','+newrgb[1]+','+newrgb[2]+','+alpha+')';mr.init();mr.draw(s.gridData[neighbor.pointIndex][0],s.gridData[neighbor.pointIndex][1],hl.highlightCanvas._ctx);}
function showTooltip(plot,series,neighbor){var hl=plot.plugins.highlighter;var elem=hl._tooltipElem;var serieshl=series.highlighter||{};var opts=$.extend(true,{},hl,serieshl);if(opts.useAxesFormatters){var xf=series._xaxis._ticks[0].formatter;var yf=series._yaxis._ticks[0].formatter;var xfstr=series._xaxis._ticks[0].formatString;var yfstr=series._yaxis._ticks[0].formatString;var str;var xstr=xf(xfstr,neighbor.data[0]);var ystrs=[];for(var i=1;i<opts.yvalues+1;i++){ystrs.push(yf(yfstr,neighbor.data[i]));}
if(typeof opts.formatString==='string'){switch(opts.tooltipAxes){case'both':case'xy':ystrs.unshift(xstr);ystrs.unshift(opts.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;case'yx':ystrs.push(xstr);ystrs.unshift(opts.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;case'x':str=$.jqplot.sprintf.apply($.jqplot.sprintf,[opts.formatString,xstr]);break;case'y':ystrs.unshift(opts.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;default:ystrs.unshift(xstr);ystrs.unshift(opts.formatString);str=$.jqplot.sprintf.apply($.jqplot.sprintf,ystrs);break;}}
else{switch(opts.tooltipAxes){case'both':case'xy':str=xstr;for(var i=0;i<ystrs.length;i++){str+=opts.tooltipSeparator+ystrs[i];}
break;case'yx':str='';for(var i=0;i<ystrs.length;i++){str+=ystrs[i]+opts.tooltipSeparator;}
str+=xstr;break;case'x':str=xstr;break;case'y':str=ystrs.join(opts.tooltipSeparator);break;default:str=xstr;for(var i=0;i<ystrs.length;i++){str+=opts.tooltipSeparator+ystrs[i];}
break;}}}
else{var str;if(typeof opts.formatString==='string'){str=$.jqplot.sprintf.apply($.jqplot.sprintf,[opts.formatString].concat(neighbor.data));}
else{if(opts.tooltipAxes=='both'||opts.tooltipAxes=='xy'){str=$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[0])+opts.tooltipSeparator+$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[1]);}
else if(opts.tooltipAxes=='yx'){str=$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[1])+opts.tooltipSeparator+$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[0]);}
else if(opts.tooltipAxes=='x'){str=$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[0]);}
else if(opts.tooltipAxes=='y'){str=$.jqplot.sprintf(opts.tooltipFormatString,neighbor.data[1]);}}}
if($.isFunction(opts.tooltipContentEditor)){str=opts.tooltipContentEditor(str,neighbor.seriesIndex,neighbor.pointIndex,plot);}
elem.html(str);var gridpos={x:neighbor.gridData[0],y:neighbor.gridData[1]};var ms=0;var fact=0.707;if(series.markerRenderer.show==true){ms=(series.markerRenderer.size+opts.sizeAdjust)/2;}
var loc=locations;if(series.fillToZero&&series.fill&&neighbor.data[1]<0){loc=oppositeLocations;}
switch(loc[locationIndicies[opts.tooltipLocation]]){case'nw':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-opts.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top-opts.tooltipOffset-elem.outerHeight(true)-fact*ms;break;case'n':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)/2;var y=gridpos.y+plot._gridPadding.top-opts.tooltipOffset-elem.outerHeight(true)-ms;break;case'ne':var x=gridpos.x+plot._gridPadding.left+opts.tooltipOffset+fact*ms;var y=gridpos.y+plot._gridPadding.top-opts.tooltipOffset-elem.outerHeight(true)-fact*ms;break;case'e':var x=gridpos.x+plot._gridPadding.left+opts.tooltipOffset+ms;var y=gridpos.y+plot._gridPadding.top-elem.outerHeight(true)/2;break;case'se':var x=gridpos.x+plot._gridPadding.left+opts.tooltipOffset+fact*ms;var y=gridpos.y+plot._gridPadding.top+opts.tooltipOffset+fact*ms;break;case's':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)/2;var y=gridpos.y+plot._gridPadding.top+opts.tooltipOffset+ms;break;case'sw':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-opts.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top+opts.tooltipOffset+fact*ms;break;case'w':var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-opts.tooltipOffset-ms;var y=gridpos.y+plot._gridPadding.top-elem.outerHeight(true)/2;break;default:var x=gridpos.x+plot._gridPadding.left-elem.outerWidth(true)-opts.tooltipOffset-fact*ms;var y=gridpos.y+plot._gridPadding.top-opts.tooltipOffset-elem.outerHeight(true)-fact*ms;break;}
elem.css('left',x);elem.css('top',y);if(opts.fadeTooltip){elem.stop(true,true).fadeIn(opts.tooltipFadeSpeed);}
else{elem.show();}
elem=null;}
function handleMove(ev,gridpos,datapos,neighbor,plot){var hl=plot.plugins.highlighter;var c=plot.plugins.cursor;if(hl.show){if(neighbor==null&&hl.isHighlighting){var evt=jQuery.Event('jqplotHighlighterUnhighlight');plot.target.trigger(evt);var ctx=hl.highlightCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);if(hl.fadeTooltip){hl._tooltipElem.fadeOut(hl.tooltipFadeSpeed);}
else{hl._tooltipElem.hide();}
if(hl.bringSeriesToFront){plot.restorePreviousSeriesOrder();}
hl.isHighlighting=false;hl.currentNeighbor=null;ctx=null;}
else if(neighbor!=null&&plot.series[neighbor.seriesIndex].showHighlight&&!hl.isHighlighting){var evt=jQuery.Event('jqplotHighlighterHighlight');evt.which=ev.which;evt.pageX=ev.pageX;evt.pageY=ev.pageY;var ins=[neighbor.seriesIndex,neighbor.pointIndex,neighbor.data,plot];plot.target.trigger(evt,ins);hl.isHighlighting=true;hl.currentNeighbor=neighbor;if(hl.showMarker){draw(plot,neighbor);}
if(plot.series[neighbor.seriesIndex].show&&hl.showTooltip&&(!c||!c._zoom.started)){showTooltip(plot,plot.series[neighbor.seriesIndex],neighbor);}
if(hl.bringSeriesToFront){plot.moveSeriesToFront(neighbor.seriesIndex);}}
else if(neighbor!=null&&hl.isHighlighting&&hl.currentNeighbor!=neighbor){if(plot.series[neighbor.seriesIndex].showHighlight){var ctx=hl.highlightCanvas._ctx;ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);hl.isHighlighting=true;hl.currentNeighbor=neighbor;if(hl.showMarker){draw(plot,neighbor);}
if(plot.series[neighbor.seriesIndex].show&&hl.showTooltip&&(!c||!c._zoom.started)){showTooltip(plot,plot.series[neighbor.seriesIndex],neighbor);}
if(hl.bringSeriesToFront){plot.moveSeriesToFront(neighbor.seriesIndex);}}}}}})(jQuery);(function($){$.jqplot.PointLabels=function(options){this.show=$.jqplot.config.enablePlugins;this.location='n';this.labelsFromSeries=false;this.seriesLabelIndex=null;this.labels=[];this._labels=[];this.stackedValue=false;this.ypadding=6;this.xpadding=6;this.escapeHTML=true;this.edgeTolerance=-5;this.formatter=$.jqplot.DefaultTickFormatter;this.formatString='';this.hideZeros=false;this._elems=[];$.extend(true,this,options);};var locations=['nw','n','ne','e','se','s','sw','w'];var locationIndicies={'nw':0,'n':1,'ne':2,'e':3,'se':4,'s':5,'sw':6,'w':7};var oppositeLocations=['se','s','sw','w','nw','n','ne','e'];$.jqplot.PointLabels.init=function(target,data,seriesDefaults,opts,plot){var options=$.extend(true,{},seriesDefaults,opts);options.pointLabels=options.pointLabels||{};if(this.renderer.constructor===$.jqplot.BarRenderer&&this.barDirection==='horizontal'&&!options.pointLabels.location){options.pointLabels.location='e';}
this.plugins.pointLabels=new $.jqplot.PointLabels(options.pointLabels);this.plugins.pointLabels.setLabels.call(this);};$.jqplot.PointLabels.prototype.setLabels=function(){var p=this.plugins.pointLabels;var labelIdx;if(p.seriesLabelIndex!=null){labelIdx=p.seriesLabelIndex;}
else if(this.renderer.constructor===$.jqplot.BarRenderer&&this.barDirection==='horizontal'){labelIdx=(this._plotData[0].length<3)?0:this._plotData[0].length-1;}
else{labelIdx=(this._plotData.length===0)?0:this._plotData[0].length-1;}
p._labels=[];if(p.labels.length===0||p.labelsFromSeries){if(p.stackedValue){if(this._plotData.length&&this._plotData[0].length){for(var i=0;i<this._plotData.length;i++){p._labels.push(this._plotData[i][labelIdx]);}}}
else{var d=this.data;if(this.renderer.constructor===$.jqplot.BarRenderer&&this.waterfall){d=this._data;}
if(d.length&&d[0].length){for(var i=0;i<d.length;i++){p._labels.push(d[i][labelIdx]);}}
d=null;}}
else if(p.labels.length){p._labels=p.labels;}};$.jqplot.PointLabels.prototype.xOffset=function(elem,location,padding){location=location||this.location;padding=padding||this.xpadding;var offset;switch(location){case'nw':offset=-elem.outerWidth(true)-this.xpadding;break;case'n':offset=-elem.outerWidth(true)/2;break;case'ne':offset=this.xpadding;break;case'e':offset=this.xpadding;break;case'se':offset=this.xpadding;break;case's':offset=-elem.outerWidth(true)/2;break;case'sw':offset=-elem.outerWidth(true)-this.xpadding;break;case'w':offset=-elem.outerWidth(true)-this.xpadding;break;default:offset=-elem.outerWidth(true)-this.xpadding;break;}
return offset;};$.jqplot.PointLabels.prototype.yOffset=function(elem,location,padding){location=location||this.location;padding=padding||this.xpadding;var offset;switch(location){case'nw':offset=-elem.outerHeight(true)-this.ypadding;break;case'n':offset=-elem.outerHeight(true)-this.ypadding;break;case'ne':offset=-elem.outerHeight(true)-this.ypadding;break;case'e':offset=-elem.outerHeight(true)/2;break;case'se':offset=this.ypadding;break;case's':offset=this.ypadding;break;case'sw':offset=this.ypadding;break;case'w':offset=-elem.outerHeight(true)/2;break;default:offset=-elem.outerHeight(true)-this.ypadding;break;}
return offset;};$.jqplot.PointLabels.draw=function(sctx,options,plot){var p=this.plugins.pointLabels;p.setLabels.call(this);for(var i=0;i<p._elems.length;i++){p._elems[i].emptyForce();}
p._elems.splice(0,p._elems.length);if(p.show){var ax='_'+this._stackAxis+'axis';if(!p.formatString){p.formatString=this[ax]._ticks[0].formatString;p.formatter=this[ax]._ticks[0].formatter;}
var pd=this._plotData;var ppd=this._prevPlotData;var xax=this._xaxis;var yax=this._yaxis;var elem,helem;for(var i=0,l=p._labels.length;i<l;i++){var label=p._labels[i];if(label==null||(p.hideZeros&&parseInt(label,10)==0)){continue;}
label=p.formatter(p.formatString,label);helem=document.createElement('div');p._elems[i]=$(helem);elem=p._elems[i];elem.addClass('jqplot-point-label jqplot-series-'+this.index+' jqplot-point-'+i);elem.css('position','absolute');elem.insertAfter(sctx.canvas);if(p.escapeHTML){elem.text(label);}
else{elem.html(label);}
var location=p.location;if((this.fillToZero&&pd[i][1]<0)||(this.fillToZero&&this._type==='bar'&&this.barDirection==='horizontal'&&pd[i][0]<0)||(this.waterfall&&parseInt(label,10))<0){location=oppositeLocations[locationIndicies[location]];}
var ell=xax.u2p(pd[i][0])+p.xOffset(elem,location);var elt=yax.u2p(pd[i][1])+p.yOffset(elem,location);if(this._stack&&!p.stackedValue){if(this.barDirection==="vertical"){elt=(this._barPoints[i][0][1]+this._barPoints[i][1][1])/2+plot._gridPadding.top-0.5*elem.outerHeight(true);}
else{ell=(this._barPoints[i][2][0]+this._barPoints[i][0][0])/2+plot._gridPadding.left-0.5*elem.outerWidth(true);}}
if(this.renderer.constructor==$.jqplot.BarRenderer){if(this.barDirection=="vertical"){ell+=this._barNudge;}
else{elt-=this._barNudge;}}
elem.css('left',ell);elem.css('top',elt);var elr=ell+elem.width();var elb=elt+elem.height();var et=p.edgeTolerance;var scl=$(sctx.canvas).position().left;var sct=$(sctx.canvas).position().top;var scr=sctx.canvas.width+scl;var scb=sctx.canvas.height+sct;if(ell-et<scl||elt-et<sct||elr+et>scr||elb+et>scb){elem.remove();}
elem=null;helem=null;}}};$.jqplot.postSeriesInitHooks.push($.jqplot.PointLabels.init);$.jqplot.postDrawSeriesHooks.push($.jqplot.PointLabels.draw);})(jQuery);var nar=nar||{};nar.commons=nar.commons||{};nar.commons.map=nar.commons.map||{};(function(){nar.commons.map.projection=new OpenLayers.Projection('EPSG:900913');nar.commons.map.geographicProjection=new OpenLayers.Projection('EPSG:4326');nar.commons.map.narNamespace='http://cida.usgs.gov/NAR';nar.commons.map.sitesName='JD_NFSN_sites';nar.commons.map.theme=CONFIG.staticUrl+'nar_ui/js_lib/OpenLayers/theme/default/style.css';var DEFAULT_LAYER_OPTIONS={sphericalMercator:true,layers:"0",isBaseLayer:true,projection:nar.commons.map.projection,units:"m",buffer:3,wrapDateLine:false};nar.commons.mapUtils={createBaseLayers:function(layerOptions){var _layerOptions=layerOptions||DEFAULT_LAYER_OPTIONS;var zyx='/MapServer/tile/${z}/${y}/${x}';var ArcGisLayer=function(name,identifier){return new OpenLayers.Layer.XYZ(name,"http://services.arcgisonline.com/ArcGIS/rest/services/"+identifier+zyx,_layerOptions);};var baseLayers=[ArcGisLayer("World Topo Map",'World_Topo_Map'),ArcGisLayer("World Image","World_Imagery"),ArcGisLayer("World Shaded Relief","World_Shaded_Relief"),ArcGisLayer('World Street Map','World_Street_Map')];return baseLayers;},createNlcdLayers:function(layerOptions){var _layerOptions=layerOptions||DEFAULT_LAYER_OPTIONS;var nlcdUrl='http://raster.nationalmap.gov/arcgis/services/LandCover/USGS_EROS_LandCover_NLCD/MapServer/WMSServer';var nlcdProjection='EPSG:3857';var nlcdContiguousUsOptions=Object.clone(_layerOptions);nlcdContiguousUsOptions.displayInLayerSwitcher=true;nlcdContiguousUsOptions.isBaseLayer=false;nlcdContiguousUsOptions.projection=nlcdProjection;nlcdContiguousUsOptions.visibility=false;var nlcdContiguousUsParams={layers:'24',transparent:true,tiled:true};var nlcdContiguousUsLayer=new OpenLayers.Layer.WMS('NLCD',nlcdUrl,nlcdContiguousUsParams,nlcdContiguousUsOptions);var nlcdAlaskaOptions=Object.clone(_layerOptions);nlcdAlaskaOptions.displayInLayerSwitcher=false;nlcdAlaskaOptions.isBaseLayer=false;nlcdAlaskaOptions.projection=nlcdProjection;nlcdAlaskaOptions.visibility=false;var nlcdAlaskaParams={layers:'18',transparent:true,tiled:true};var nlcdAlaskaLayer=new OpenLayers.Layer.WMS('NLCD Alaska',nlcdUrl,nlcdAlaskaParams,nlcdAlaskaOptions);nlcdContiguousUsLayer.events.register('visibilitychanged',{},function(){nlcdAlaskaLayer.setVisibility(nlcdContiguousUsLayer.visibility);});var nlcdLayers=[nlcdContiguousUsLayer,nlcdAlaskaLayer];return nlcdLayers;},createSitesLayer:function(layerOptions){var _layerOptions=layerOptions||DEFAULT_LAYER_OPTIONS;var sitesLayerOptions=Object.clone(_layerOptions);sitesLayerOptions.singleTile=true;sitesLayerOptions.isBaseLayer=false;var sitesLayerParams={layers:nar.commons.map.sitesName,buffer:8,transparent:true,styles:'sites'};var sitesLayer=new OpenLayers.Layer.WMS('NAWQA Sites',CONFIG.endpoint.geoserver+'NAR/wms',sitesLayerParams,sitesLayerOptions);return sitesLayer;},createSitesFeatureProtocol:function(protocolOptions){var protocol=new OpenLayers.Protocol.WFS({version:'1.1.0',url:CONFIG.endpoint.geoserver+'NAR/wfs',featureType:nar.commons.map.sitesName,featureNS:nar.commons.map.narNamespace});return protocol;},getData:function(protocol,filter,callback){if(protocol){protocol.read({callback:callback,filter:filter});}}}}());var nar=nar||{};nar.WaterYearUtils=(function(){"use strict";var extractYear=function(date){return date.format('{yyyy}').toNumber();};var convertDateToWaterYear=function(date){var sDate=date?Date.create(date):Date.create();var year=extractYear(sDate);if(sDate.is('October')||sDate.is('November')||sDate.is('December')){year=year+1;}
return year;};var getWaterYearStart=function(waterYear,utc){var start;if(utc){start=Date.create(Date.UTC(waterYear-1,9,1))}else{start=Date.create(waterYear-1,9,1);}
return start;};var getWaterYearEnd=function(waterYear,utc){var end;if(utc){end=Date.create(Date.UTC(waterYear,8,30));}else{end=Date.create(waterYear,8,30);}
return end;};var getWaterYearRange=function(range,utc){var wyStart,wyEnd;var oct1=(utc)?Date.create(Date.UTC(extractYear(range.start),9,1)):Date.create(extractYear(range.start),9,1);var sep30=(utc)?Date.create(Date.UTC(extractYear(range.end),8,30)):Date.create(extractYear(range.end),8,30);if(oct1.isAfter(range.start)||oct1.is(range.start)){wyStart=oct1;}else{wyStart=oct1.advance('1 year');}
if(sep30.isBefore(range.end)||sep30.is(range.end)){wyEnd=sep30;}else{wyEnd=sep30.rewind('1 year');}
return Date.range(wyStart,wyEnd);};var getYearsAsArray=function(range,descending){var years=[];if(range&&range.start<range.end){range.every('year',function(d){if(descending){years.unshift(convertDateToWaterYear(d));}else{years.push(convertDateToWaterYear(d));}});}
return years;};return{extractYear:extractYear,convertDateToWaterYear:convertDateToWaterYear,getWaterYearStart:getWaterYearStart,getWaterYearEnd:getWaterYearEnd,getWaterYearRange:getWaterYearRange,getYearsAsArray:getYearsAsArray};}());var nar=nar||{};(function(){nar.timeSeries=nar.timeSeries||{};nar.timeSeries.TimeRange=function(startTime,endTime){var self=this;self.startTime=nar.util.getTimeStamp(startTime);self.endTime=nar.util.getTimeStamp(endTime);self.clone=function(){return nar.timeSeries.TimeRange.clone(self);};self.equals=function(otherTimeRange){return nar.timeSeries.TimeRange.equals(self,otherTimeRange);};self.contains=function(date){var timestamp=nar.util.getTimeStamp(date);return(timestamp>=self.startTime&&timestamp<=self.endTime);};self.trimStartTime=function(cutoffDate){var chosenCutoffDate=cutoffDate||nar.timeSeries.TimeRange.START_TIME_CUTOFF;self.startTime=Math.max(chosenCutoffDate,self.startTime);};self.trimEndTime=function(cutoffDate){var chosenCutoffDate=cutoffDate||nar.timeSeries.TimeRange.END_TIME_CUTOFF;self.endTime=Math.min(chosenCutoffDate,self.endTime);};};nar.timeSeries.TimeRange.START_TIME_CUTOFF=new Date(1992,9,1).getTime();nar.timeSeries.TimeRange.END_TIME_CUTOFF=new Date(nar.WaterYearUtils.convertDateToWaterYear(Date.now())-1,8,30,23,59,59).getTime();nar.timeSeries.TimeRange.clone=function(timeRange){return new nar.timeSeries.TimeRange(timeRange.startTime,timeRange.endTime);};nar.timeSeries.TimeRange.equals=function(timeRangeA,timeRangeB){var equal=false;if(undefined!==timeRangeA&&undefined!==timeRangeB){if(timeRangeA.constructor===nar.timeSeries.TimeRange&&timeRangeB.constructor===nar.timeSeries.TimeRange){equal=timeRangeA.startTime===timeRangeB.startTime&&timeRangeA.endTime===timeRangeB.endTime;}}
return equal;};nar.timeSeries.TimeRange.ofAll=function(timeRanges){var timeExtentExtremityFinder=function(init,current){init.startTime=Math.min(init.startTime,current.startTime);init.endTime=Math.max(init.endTime,current.endTime);return init;};var firstTimeRange=timeRanges.first();if(firstTimeRange){var initValue=firstTimeRange.clone();var maxExtent=timeRanges.reduce(timeExtentExtremityFinder,initValue);return maxExtent;}};}());var nar=nar||{};(function(){nar.timeSeries=nar.timeSeries||{};nar.timeSeries.TimeSeries=function(config){var self=this;self.procedure=config.procedure;self.observedProperty=config.observedProperty;self.timeRange=config.timeRange||null;self.featureOfInterest=config.featureOfInterest;self.data=undefined;self.parseSosGetResultResponse=function(response){var errorMessage='error retrieving data';var dataToReturn=null;if(response.exception){console.dir(response.exception);alert(errorMessage);}
else{if(response.resultValues){var rows=response.resultValues.split('@');rows=rows.from(1);var dateIndex=0;var rowSplitToken=',';dataToReturn=rows.map(function(row){var tokens=row.split(rowSplitToken);var timeStamp=Date.create(tokens[dateIndex]).getTime();tokens[dateIndex]=timeStamp;return tokens;});}
else{console.dir(response);alert(errorMessage);}}
return dataToReturn;};self.retrieveData=function(){var getResultParams={"request":"GetResult","service":"SOS","version":"2.0.0","offering":self.procedure,"observedProperty":self.observedProperty,"featureOfInterest":self.featureOfInterest,};if(self.timeRange){if(self.timeRange.startTime===self.timeRange.endTime){getResultParams.temporalFilter=[{"equals":{"ref":"om:phenomenonTime","value":nar.util.toISOString(self.timeRange.endTime)}}];}
else{getResultParams.temporalFilter=[{"during":{"ref":"om:phenomenonTime","value":[nar.util.toISOString(self.timeRange.startTime),nar.util.toISOString(self.timeRange.endTime+1000)]}}];}}
var deferred=$.Deferred();var dataRetrieval=$.ajax({url:CONFIG.endpoint.sos+'/json',type:'POST',data:JSON.stringify(getResultParams),contentType:'application/json',success:function(response,textStatus,jqXHR){self.data=self.parseSosGetResultResponse(response);if(!self.timeRange){self.timeRange=new nar.timeSeries.TimeRange(self.data[0][0],self.data[self.data.length-1][0]);}
deferred.resolve(self);},error:function(data,textStatus,jqXHR){deferred.reject(data);}});var promise=deferred.promise();return promise;};};nar.timeSeries.DataAvailabilityTimeRange=function(dataAvailability,useOriginalTimes){var startTimeIndex=0;var endTimeIndex=1;var timeRange=new nar.timeSeries.TimeRange(dataAvailability.phenomenonTime[startTimeIndex],dataAvailability.phenomenonTime[endTimeIndex]);if(!useOriginalTimes){timeRange.trimStartTime();timeRange.trimEndTime();}
return timeRange;};nar.timeSeries.WaterYearTimeRange=function(wy){var startTime=nar.WaterYearUtils.getWaterYearStart(wy,true).rewind('1 minute');var endTime=nar.WaterYearUtils.getWaterYearEnd(wy,true).advance('1 minute');var yearRange=new nar.timeSeries.TimeRange(startTime,endTime);return yearRange;};}());var nar=nar||{};nar.timeSeries=nar.timeSeries||{};nar.timeSeries.Collection=function(){var self=this;var timeSeries=[];var dirty=true;var cachedTimeRange;self.map=function(customFunction){return timeSeries.map(customFunction);};self.reduce=function(customFunction,init){return timeSeries.reduce(customFunction,init);};self.retrieveData=function(){var retrievalPromises=self.map(function(timeSeries){return timeSeries.retrieveData();});return retrievalPromises;};self.getAll=function(){return timeSeries;};self.getData=function(){var data=self.map(function(timeSeries){return timeSeries.data;});return data;};self.getDataMerged=function(){var merged=self.reduce(function(state,current){return state.concat(current.data);},[]);var sorted=merged.sortBy(function(point){return point[0];});return sorted;};self.add=function(aTimeSeries){timeSeries.push(aTimeSeries);dirty=true;};self.getTimeRange=function(){if(dirty&&0!==timeSeries.length){var timeRanges=timeSeries.map(function(aTimeSeries){return aTimeSeries.timeRange;});cachedTimeRange=nar.timeSeries.TimeRange.ofAll(timeRanges);dirty=false;}
return cachedTimeRange.clone();};self.getTimeSeriesByObservedProperty=function(observedProperty){var targetTimeSeries=timeSeries.find(function(potentialTimeSeries){return potentialTimeSeries.observedProperty===observedProperty;});return targetTimeSeries;};};var nar=nar||{};nar.plots=nar.plots||{};(function(){var getXcoord=function(point){return point[0];};var getYcoord=function(point){return point[1];};var log10=function(val){return Math.log(val)/Math.LN10;};var getPlotTooltipDiv=function(){var toolTipId='flot-tooltip';var toolTipSelector='#'+toolTipId;var toolTipSelection=$(toolTipSelector);var toolTipElt;if(0===toolTipSelection.length){toolTipElt=$('<div></div>',{'id':toolTipId});toolTipElt.appendTo('body');}else{toolTipElt=toolTipSelection[0];}
return toolTipElt;};nar.plots.PlotUtils={YEAR_NINETEEN_HUNDRED:Date.create('1900').getTime(),ONE_YEAR_IN_THE_FUTURE:Date.create().addYears(1).getTime(),getDataSplitIntoCurrentAndPreviousYears:function(data){var startOfCurrentYearTimestamp=Date.UTC(CONFIG.currentWaterYear,0,1);var indexOfFirstDataPointInCurrentYear=data.findIndex(function(dataPoint){var timestamp=getXcoord(dataPoint);return timestamp>=startOfCurrentYearTimestamp;});var result={previousYearsData:[],currentYearData:[]};if(indexOfFirstDataPointInCurrentYear===-1){result.previousYearsData=data;}
else{result.previousYearsData=data.to(indexOfFirstDataPointInCurrentYear);result.currentYearData=data.from(indexOfFirstDataPointInCurrentYear);}
return result;},getConstituentNameAndColors:function(timeSeriesVisualization){var idComponents=timeSeriesVisualization.getComponentsOfId();var constituentId=idComponents.constituent;var constituentInfo=nar.Constituents[constituentId];var constituentName=constituentInfo.name;var currentYearColor=constituentInfo.color;var previousYearsColor=tinycolor.lighten(tinycolor(currentYearColor),30).toRgbString();var longTermMeanColor=tinycolor.lighten(tinycolor.gray,75).toRgbString();var criteriaLineColor=tinycolor.lighten(tinycolor.gray,75).toRgbString();return{name:constituentName,colors:{currentYear:currentYearColor,previousYears:previousYearsColor,longTermMean:longTermMeanColor,criteriaLine:criteriaLineColor,}};},calculateLongTermAverage:function(timeSeriesVisualization){var allData=timeSeriesVisualization.timeSeriesCollection.map(function(timeSeries){return timeSeries.data;});var data=allData[0];var avg=data.average(function(n){return parseFloat(getYcoord(n));});return avg;},setPlotHoverFormatter:function(plotContainer,formatter){var toolTipElt=getPlotTooltipDiv();$(plotContainer).bind("plothover",function(event,pos,item){if(item){var x=item.datapoint[0],y=item.datapoint[1];var hoverText=formatter(x,y);$(toolTipElt).html(hoverText).css({top:item.pageY+5,left:item.pageX+5,'z-index':760}).fadeIn(200);}else{$(toolTipElt).hide();}});},setLineHoverFormatter:function(plotContainer,yvalue,text){var toolTipElt=getPlotTooltipDiv();var hoverThreshold=0.05;$(plotContainer).bind("plothover",function(event,pos,item){if(!item){if(Math.abs(log10(pos.y)-log10(yvalue))<hoverThreshold){$(toolTipElt).html(text).css({top:pos.pageY+5,left:pos.pageX+5,'z-index':760}).fadeIn(200);}}});},utcDatePlotHoverFormatter:function(x,y){var date=Date.create(x).utc(true);var dateStr=date.format(Date.ISO8601_DATE);var formatted=dateStr+" : "+y;return formatted;},waterYearPlotHoverFormatter:function(x,y,yPrecision){return nar.WaterYearUtils.convertDateToWaterYear(x)+' : '+y.format(yPrecision);},logTickFormatter:function(val,axis){var roundedLog=Math.round(log10(val));var tickDecimals=(roundedLog>0)?0:-roundedLog;return val.toFixed(tickDecimals);},getTicksByYear:function(axis){var tFirstYear,tLastYear;var thisDate,maxDate;var result=axis.tickGenerator(axis);if(result.length>1){tFirstYear=(new Date(result[0])).getFullYear();tLastYear=(new Date(result[result.length-1])).getFullYear();if(tLastYear-tFirstYear<result.length){thisDate=new Date(tFirstYear,0,1);maxDate=new Date(axis.max);result=[];while(thisDate<maxDate){result.push(thisDate.getTime());thisDate.setFullYear(thisDate.getFullYear()+1);}}}
return result;},createPinnedPointData:function(pointData,lineData){var pinnedPoints=pointData.map(function(point){point[1]=nar.plots.PlotUtils.findNearestYValueAtX(lineData,point[0]);return point;});return pinnedPoints;},findNearestYValueAtX:function(array,xvalue,xindex,yindex){var xi=(xindex===undefined)?0:xindex;var yi=(yindex===undefined)?1:yindex;var point=array.reduce(function(prev,curr){return(Math.abs(curr[xi]-xvalue))<Math.abs(prev[xi]-xvalue)?curr:prev;});return point[yi];},getLogAxisForValue:function(value,func){var logValue=log10(value);var factor=func(logValue);return Math.pow(10,factor);}};}());var nar=nar||{};(function(){nar.Constituents={ammonia:{color:'#CAFF70',name:'Ammonia'},orthoP:{color:'#C1FFC1',name:'Ortho Phosphate'},nitrogen:{color:'#6E8B3D',name:'Total Nitrogen'},pesticides:{color:'#008080',name:'Pesticides'},ecology:{color:'#808000',name:'Ecology'},nitrate:{color:'#7FFF00',name:'Nitrate'},phosphorus:{color:'#698B69',name:'Total Phosphorus'},sediment:{color:'#8B0000',name:'Suspended Sediment'},streamflow:{color:'#0000CD',name:'Streamflow'}};})();var nar=nar||{};nar.plots=nar.plots||{};nar.plots.createCoastalBasinPlot=function(config){var avgData=[];var currentYearData=[];var dataValue=function(dataPoint){return parseFloat(dataPoint[1]);};var yTickOptions={};var avgLabels=[];var curLabels=[];if(Object.has(config,'yaxisFormatter')){yTickOptions.formatter=config.yaxisFormatter;}
config.tsCollections.forEach(function(tsC){var sortedData=tsC.getDataMerged();var splitData=nar.plots.PlotUtils.getDataSplitIntoCurrentAndPreviousYears(sortedData);if(splitData.previousYearsData.length===0){avgData.push(0);avgLabels.push('NA');}
else{avgData.push(splitData.previousYearsData.average(dataValue));avgLabels.push('');}
if(splitData.currentYearData.length===0){currentYearData.push(0);curLabels.push('NA');}
else{currentYearData.push(dataValue(splitData.currentYearData.first()));curLabels.push('');}});$.jqplot(config.plotDivId,[avgData,currentYearData],{seriesDefaults:{renderer:$.jqplot.BarRenderer,rendererOptions:{barPadding:0,barMargin:20,barDirection:'vertical'},shadow:false},series:[{label:'Average: '+CONFIG.startWaterYear+'-'+(CONFIG.currentWaterYear-1),color:"#A0A0A0",pointLabels:{show:true,labels:avgLabels,location:'n'}},{label:CONFIG.currentWaterYear,color:nar.Constituents.nitrate.color,pointLabels:{show:true,labels:curLabels,location:'n'}}],legend:{show:true,placement:'insideGrid',location:'nw'},title:{text:config.title,show:Object.has(config,'title')},grid:{drawGridlines:false,shadow:false},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:config.tickLabels,},yaxis:{label:config.yaxisLabel,showLabel:Object.has(config,'yaxisLabel'),labelRenderer:$.jqplot.CanvasAxisLabelRenderer,tickOptions:yTickOptions}},highlighter:{show:true,showMarker:false,showToolTip:true,tooltipLocation:'n',tooltipAxes:'y',}});};var nar=nar||{};nar.coastalRegion=nar.coastalRegion||{};nar.coastalRegion.map=function(geoserverEndpoint,region){var me={};var WMS_URL=geoserverEndpoint+'NAR/wms';var WFS_URL=geoserverEndpoint+'NAR/wfs';var REGION={northeast:{inset:'ne_inset',streams:'ne_streams',sites_sld:CONFIG.site_slds.northeast,extent:new OpenLayers.Bounds(-79.2,37.2,-70.5,44.5).transform(nar.commons.map.geographicProjection,nar.commons.map.projection),resolution:2300},southeast:{inset:'se_inset',streams:'se_streams',sites_sld:CONFIG.site_slds.southeast,extent:new OpenLayers.Bounds(-84.0,32.0,-78.0,36.0).transform(nar.commons.map.geographicProjection,nar.commons.map.projection),resolution:1600},gulf:{inset:'gulf_inset',streams:'gulf_streams',sites_sld:CONFIG.site_slds.gulf,resolution:7400,extent:new OpenLayers.Bounds(-114.0,24.5,-78.0,50.5).transform(nar.commons.map.geographicProjection,nar.commons.map.projection),},west:{inset:'west_inset',streams:'west_streams',sites_sld:CONFIG.site_slds.west,extent:new OpenLayers.Bounds(-136.0,26.0,-104.0,54.5).transform(nar.commons.map.geographicProjection,nar.commons.map.projection),resolution:6300},alaska:{inset:'westAKonly_inset',streams:'westAKonly_streams',sites_sld:CONFIG.site_slds.alaska,extent:new OpenLayers.Bounds(-177.0,54.0,-134.0,71.0).transform(nar.commons.map.geographicProjection,nar.commons.map.projection),resolution:9000}};var NAR_NS='NAR:';var getFeatureBoundingBox=$.Deferred();var createStatesBaseLayer=function(){return new OpenLayers.Layer.WMS("United States",WMS_URL,{layers:NAR_NS+'statesl48_alb',transparent:true,styles:'ms_grey_outline'},{isBaseLayer:true});};var createAlaskaOutlineLayer=function(){return new OpenLayers.Layer.WMS("Alaska",WMS_URL,{layers:NAR_NS+'ak_alb',transparent:true,styles:'ms_grey_outline'},{isBaseLayer:false});};var createSitesLayer=function(sld){return new OpenLayers.Layer.WMS("Sites",WMS_URL,{layers:[NAR_NS+'JD_NFSN_sites'],transparent:true,version:'1.1.1','SLD_BODY':sld,'CQL_FILTER':"site_type = 'Coastal Rivers'"},{isBaseLayer:false,singleTile:true,tileOptions:{maxGetUrlLength:1024}});};var createBasinLayers=function(){return[new OpenLayers.Layer.WMS(region+' Basin',WMS_URL,{layers:NAR_NS+REGION[region].inset,transparent:true,styles:'coastal_basins'},{isBaseLayer:false,singleTile:true}),new OpenLayers.Layer.WMS(region+' Streams',WMS_URL,{layers:NAR_NS+REGION[region].streams,transparent:true,styles:'streams'},{isBaseLayer:false,singleTile:true})];};var createAlaskaBasinLayers=function(){return[new OpenLayers.Layer.WMS('Alaska Basin',WMS_URL,{layers:NAR_NS+REGION.alaska.inset,transparent:true,styles:'coastal_basins'},{isBaseLayer:false,singleTile:true}),new OpenLayers.Layer.WMS(region+' Basin',WMS_URL,{layers:NAR_NS+REGION.alaska.streams,transparent:true,styles:'streams'},{isBaseLayer:false,singleTile:true})];};var createDefaultMapOptions=function(){return{projection:nar.commons.map.projection,theme:nar.commons.map.theme,restrictedExtent:REGION[region].extent,maxExtent:REGION[region].extent,maxResolution:REGION[region].resolution,controls:[],layers:[createStatesBaseLayer()].concat(createBasinLayers())};};var createDefaultAlaskaMapOptions=function(){return{projection:nar.commons.map.projection,theme:nar.commons.map.theme,restrictedExtent:REGION.alaska.extent,maxExtent:REGION.alaska.extent,controls:[],layers:[createStatesBaseLayer()].concat([createAlaskaOutlineLayer()]).concat(createAlaskaBasinLayers())};};me.createRegionMap=function(mapDiv,akInsetMapDiv){var map=new OpenLayers.Map(mapDiv,createDefaultMapOptions());;$.ajax({url:REGION[region].sites_sld,type:'GET',dataType:'text',success:function(data){map.addLayer(createSitesLayer(data));}});var akMap;if(region==='west'){$('#'+akInsetMapDiv).parent().show();akMap=new OpenLayers.Map(akInsetMapDiv,createDefaultAlaskaMapOptions());$.ajax({url:REGION.alaska.sites_sld,type:'GET',dataType:'text',success:function(data){akMap.addLayer(createSitesLayer(data));}});akMap.zoomToExtent(REGION.alaska.extent);}
else{$('#'+akInsetMapDiv).parent().hide();}
map.zoomToExtent(REGION[region].extent);return map;};me.getBasinFeatureInfoPromise=function(properties){var regionDeferred=$.Deferred();var alaskaDeferred=$.Deferred();var deferred=$.Deferred();if(!properties){properties=[];}
$.ajax({url:WFS_URL,method:'GET',data:{service:'wfs',version:'1.1.0',dataType:'text',request:'GetFeature',typeNames:NAR_NS+REGION[region].inset,propertyName:properties.join(',')},success:function(response){var gmlReader=new OpenLayers.Format.GML.v3();regionDeferred.resolve(gmlReader.read(response));},error:function(){regionDeferred.reject();}});if(region==='west'){alaskaDeferred=$.Deferred();$.ajax({url:WFS_URL,method:'GET',data:{service:'wfs',version:'1.1.0',dataType:'text',request:'GetFeature',typeNames:NAR_NS+REGION.alaska.inset,propertyName:properties.join(',')},success:function(response){var gmlReader=new OpenLayers.Format.GML.v3();alaskaDeferred.resolve(gmlReader.read(response));},error:function(){alaskaDeferred.reject();}});}
else{alaskaDeferred.resolve([]);}
$.when(regionDeferred,alaskaDeferred).then(function(f1,f2){deferred.resolve(f1.concat(f2));}).fail(function(){deferred.reject();});return deferred;};return me;};(function(){CONFIG.startWaterYear=1993;CONFIG.siteIdAttribute='STAID',CONFIG.riverNameAttribute='River';var coastalRegionMap=nar.coastalRegion.map(CONFIG.endpoint.geoserver,CONFIG.region);var getBasinFeatureInfoPromise=coastalRegionMap.getBasinFeatureInfoPromise([CONFIG.siteIdAttribute,CONFIG.riverNameAttribute]);var dataTimeRange=new nar.timeSeries.TimeRange(nar.WaterYearUtils.getWaterYearStart(CONFIG.startWaterYear,true),nar.WaterYearUtils.getWaterYearEnd(CONFIG.currentWaterYear,true));$(document).ready(function(){"use strict";var map=coastalRegionMap.createRegionMap('region_coast_map','region_coast_ak_inset_map');var getTimeSeriesCollection=function(forFeature,availability){var result=new nar.timeSeries.Collection();var thisFeatureAvailability=availability.filter(function(value){return value.featureOfInterest===forFeature;});thisFeatureAvailability.each(function(value){var ts=new nar.timeSeries.TimeSeries({timeRange:dataTimeRange,observedProperty:value.observedProperty,procedure:value.procedure,featureOfInterest:value.featureOfInterest});result.add(ts);});return result;};getBasinFeatureInfoPromise.then(function(response){var basinFeatures=response;var basinSiteIds=basinFeatures.map(function(value){return value.attributes[CONFIG.siteIdAttribute];});var tickLabels=basinFeatures.map(function(value){return value.attributes[CONFIG.riverNameAttribute].replace('River','\nRiver');});var getDataAvailability=$.ajax({url:CONFIG.endpoint.sos,contentType:'application/json',type:'POST',dataType:'json',data:JSON.stringify({'request':'GetDataAvailability','service':'SOS','version':'2.0.0','observedProperty':CONFIG.sosDefsBaseUrl+'property/NO23','featureOfInterest':basinSiteIds})});$.when(getDataAvailability).then(function(availability){var loadDataAvailability=availability.dataAvailability.filter(function(value){return(value.procedure.has('annual_mass/')&&!value.procedure.has('COMP'));});var yieldDataAvailability=availability.dataAvailability.filter(function(value){return(value.procedure.has('annual_yield/')&&!value.procedure.has('COMP'));});var loadTSCollections=[];var yieldTSCollections=[];basinSiteIds.forEach(function(id){loadTSCollections.push(getTimeSeriesCollection(id,loadDataAvailability));yieldTSCollections.push(getTimeSeriesCollection(id,yieldDataAvailability));});var loadDataPromises=[];var yieldDataPromises=[];loadTSCollections.forEach(function(tsCollection){loadDataPromises=loadDataPromises.concat(tsCollection.retrieveData());});yieldTSCollections.forEach(function(tsCollection){yieldDataPromises=yieldDataPromises.concat(tsCollection.retrieveData());});$.when.apply(null,loadDataPromises).then(function(){nar.plots.createCoastalBasinPlot({plotDivId:'load_plot_div',tsCollections:loadTSCollections,tickLabels:tickLabels,yaxisLabel:'Tons',title:'Load',yaxisFormatter:function(format,value){if(Object.isNumber(value)){return value.format(0);}
else{return value;}}});});$.when.apply(null,yieldDataPromises).then(function(){nar.plots.createCoastalBasinPlot({plotDivId:'yield_plot_div',tsCollections:yieldTSCollections,tickLabels:tickLabels,yaxisLabel:'Tons per square mile',title:'Yield',yaxisFormatter:function(format,value){if(Object.isNumber(value)){return value.format(2);}
else{return value;}}});});}).fail(function(){throw Error('Unable to contact the SOS server');});});});}());