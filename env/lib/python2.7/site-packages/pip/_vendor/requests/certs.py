#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""
certs.py
~~~~~~~~

This module returns the preferred default CA certificate bundle.

If you are packaging Requests, e.g., for a Linux distribution or a managed
environment, you can change the definition of where() to return a separately
packaged CA bundle.
"""
import os.path

try:
    from certifi import where
except ImportError:
    def where():
        """Return the preferred certificate bundle."""

        ##
        ## Include the system-wide CA certificate store.
        cacert_file_search_list=[ '/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem',
                                  '/etc/ssl/certs/ca-bundle.crt',
                                  '/etc/ssl/certs/ca-certificates.crt',
                                  os.path.join(os.path.dirname(__file__), 'cacert.pem') ]
        
        for cafile in cacert_file_search_list:
            if os.path.exists(cafile):
                return cafile

        raise Exception("CA certificates file not found in: %s" % (cacert_file_search_list)) 
        ## --dekester@usgs.gov / 2016-10-12
        ##

if __name__ == '__main__':
    print(where())
